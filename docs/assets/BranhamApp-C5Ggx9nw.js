import{r as o,j as e,I as u,M as je,R as et,B as Yt,C as tt,X as st,Y as rt,T as at,a as Vt,b as _t,c as It,d as Ht,S as xe,e as Kt,L as qt,A as nt,f as ot,V as Xt,g as Gt,h as Jt,W as Qt}from"./index-CNU04wPy.js";class Zt extends o.Component{constructor(c){super(c),this.state={hasError:!1,error:null}}static getDerivedStateFromError(c){return{hasError:!0,error:c}}componentDidCatch(c,W){console.error("Uncaught error:",c,W)}render(){return this.state.hasError?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-red-50 p-4",children:e.jsxs("div",{className:"bg-white p-8 rounded-xl shadow-xl border border-red-200 max-w-lg w-full text-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-red-600 mb-4",children:"Application Error"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"A critical error stopped the dashboard."}),e.jsx("div",{className:"text-left bg-gray-100 p-2 rounded text-xs text-red-800 font-mono mb-4 overflow-auto max-h-32",children:this.state.error&&this.state.error.toString()}),e.jsx("button",{onClick:()=>window.location.reload(),className:"bg-red-600 text-white font-bold py-2 px-6 rounded hover:bg-red-700 transition",children:"Reload Page"})]})}):this.props.children}}const es="",ts="",lt=y=>y.split("/").map(c=>encodeURIComponent(c)).join("/"),it=y=>{if(!y||typeof y!="string")return null;const c=y.trim(),W=c.match(/^(.+?)\s+ONEAR\/(\d+)\s+(.+)$/i);if(W)return{type:"onear",terms:[W[1].trim(),W[3].trim()],distance:parseInt(W[2],10),ordered:!0,excluded:[]};const B=c.match(/^(.+?)\s+(?:NEAR\/(\d+)|~(\d+)|AROUND\((\d+)\))\s+(.+)$/i);if(B)return{type:"near",terms:[B[1].trim(),B[5].trim()],distance:parseInt(B[2]||B[3]||B[4],10),excluded:[]};const Z=c.match(/^(.+?)\s+(?:\/s|SENTENCE)\s+(.+)$/i);if(Z)return{type:"sentence",terms:[Z[1].trim(),Z[2].trim()],excluded:[]};const ee=c.match(/^(.+?)\s+(?:\/p|PARAGRAPH)\s+(.+)$/i);if(ee)return{type:"paragraph",terms:[ee[1].trim(),ee[2].trim()],excluded:[]};const he=c.match(/^"([^"]+)"$/);if(he)return{type:"phrase",phrase:he[1],excluded:[]};if(c.includes("(?=")&&c.includes(".*")){const f=[...c.matchAll(/\(\?=\.\*(?:\\b)?(\w+)(?:\\b)?\)/g)].map(we=>we[1]).filter(Boolean);if(f.length>=2)return{type:"and",required:f,excluded:[]}}let v=[],p=c;if(/\sNOT\s/i.test(p)){const b=p.split(/\s+NOT\s+/i);p=b[0].trim(),v=b.slice(1).map(f=>f.trim()).filter(Boolean)}const ue=[...p.matchAll(/(?:^|\s)[-!](\w+)/g)];if(ue.length>0&&(v=[...v,...ue.map(b=>b[1])],p=p.replace(/(?:^|\s)[-!]\w+/g," ").trim()),/\sOR\s/i.test(p)){const b=p.split(/\s+OR\s+/i).map(f=>f.trim()).filter(Boolean);if(b.length>=2||v.length>0)return{type:"or",required:b,excluded:v}}if(/\s*\|\s*/.test(p)){const b=p.split(/\s*\|\s*/).map(f=>f.trim()).filter(Boolean);if(b.length>=2||v.length>0)return{type:"or",required:b,excluded:v}}if(/\sAND\s/i.test(p)){const b=p.split(/\s+AND\s+/i).map(f=>f.trim()).filter(Boolean);if(b.length>=2||v.length>0)return{type:"and",required:b,excluded:v}}if(/^\+\S/.test(p)&&p.includes(" +")){const b=p.split(/\s+/).filter(f=>f.startsWith("+")).map(f=>f.slice(1).trim()).filter(Boolean);if(b.length>=2||v.length>0)return{type:"and",required:b,excluded:v}}if(/\s*&\s*/.test(p)&&!p.includes("|")){const b=p.split(/\s*&\s*/).map(f=>f.trim()).filter(Boolean);if(b.length>=2||v.length>0)return{type:"and",required:b,excluded:v}}return v.length>0&&p.trim()?{type:"and",required:[p.trim()],excluded:v}:null},ss=y=>/[*?]/.test(y),rs=y=>{let c=y.replace(/[.+^${}()|[\]\\]/g,"\\$&");return c=c.replace(/\*/g,"\\S*").replace(/\?/g,"."),c},Q=(y,c=!0)=>{if(ss(y)){const B=rs(y);return c?new RegExp(`\\b(${B})\\b`,"gi"):new RegExp(`(${B})`,"gi")}const W=y.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");return c?new RegExp(`\\b(${W})\\b`,"gi"):new RegExp(`(${W})`,"gi")};function os({onSwitchToMain:y}){const[c,W]=o.useState([]),[B,Z]=o.useState(!0),[ee,he]=o.useState(null),[v,p]=o.useState("wmb_api/"),[ue,b]=o.useState(0),[f,we]=o.useState(0),[Ee,ct]=o.useState(null),[Re,dt]=o.useState(""),[We,mt]=o.useState(0),[xt,ht]=o.useState(0),[ut,gt]=o.useState({}),[pt,bt]=o.useState([]),[j,ye]=o.useState(es),[te,ve]=o.useState(ts),[se,Ne]=o.useState(null),[ft,ge]=o.useState([]),[Be,re]=o.useState(!1),[jt,Y]=o.useState({status:"",percent:0}),Fe=o.useRef({term:null,regex:null}),[as,pe]=o.useTransition(),[le,ze]=o.useState([]),[ie,Pe]=o.useState([]),[D,Oe]=o.useState([]),[be,Ue]=o.useState([]),ce=o.useCallback(t=>pe(()=>ze(t)),[]),ae=o.useCallback(t=>pe(()=>Pe(t)),[]),q=o.useCallback(t=>pe(()=>Oe(t)),[]),Ye=o.useCallback(t=>pe(()=>Ue(t)),[]),[Ce,wt]=o.useState(26),[de,yt]=o.useState("dashboard"),[Ve,vt]=o.useState(null),[Se,V]=o.useState(null),[Nt,_]=o.useState(0),[I,Ct]=o.useState(!0),[fe,_e]=o.useState("bars"),[St,kt]=o.useState(new Set),[Tt,Ie]=o.useState({}),[Mt,$t]=o.useState({}),[He,Ke]=o.useState(new Set(["Seven Church Ages","Seven Seals"])),ke=o.useMemo(()=>({"Seven Church Ages":{dateCodes:["60-1205","60-1206","60-1207","60-1208","60-1209","60-1210","60-1211E"],color:"indigo",description:"December 5-11, 1960 - Branham Tabernacle"},"Seven Seals":{dateCodes:["63-0317E","63-0318","63-0319","63-0320","63-0321","63-0322","63-0323","63-0324E"],color:"amber",description:"March 17-24, 1963 - Branham Tabernacle"}}),[]),At=o.useCallback(t=>{const r=ke[t];return r?c.filter(s=>r.dateCodes.some(n=>s.dateCode===n||s.id?.startsWith(n))).sort((s,n)=>(s.date||"").localeCompare(n.date||"")):[]},[c,ke]),[E,Te]=o.useState({date:"",venue:"",title:"",topic:""}),[X,Me]=o.useState({key:"timestamp",direction:"desc"}),[ne,$e]=o.useState(null),[qe,Lt]=o.useState({x:0,y:0}),Dt=o.useRef(null);o.useEffect(()=>{Me(se!==null?{key:"mentionCount",direction:"desc"}:{key:"timestamp",direction:"desc"})},[se]),o.useEffect(()=>{let t=!0;return(async()=>{try{const s=["wmb_api/metadata.json","/wmbmentions.github.io/wmb_api/metadata.json","https://raw.githubusercontent.com/messageanalytics/wmbmentions.github.io/main/docs/wmb_api/metadata.json"];let n=null,a="wmb_api/";for(const x of s)try{if(n=await fetch(x),n.ok){a=x.includes("raw.githubusercontent")?"https://raw.githubusercontent.com/messageanalytics/wmbmentions.github.io/main/docs/wmb_api/":x.includes("/wmbmentions.github.io/")?"/wmbmentions.github.io/wmb_api/":"wmb_api/";break}}catch{}if(!n||!n.ok)throw new Error("WMB Metadata not found.");const l=await n.json();if(!t)return;const i=l.generated||"Unknown";ct(i),b(l.totalChunks||0),we(l.totalSermons||0),dt(l.yearRange||""),mt(l.totalWords||0),ht(l.totalDurationMinutes||0),gt(l.topicCounts||{}),bt(l.venues||[]),p(a);const g=(l.sermons||[]).map(x=>{const O=x.wordCount/Qt/60;return{...x,durationHrs:O>0?O:.5,mentionCount:0,mentionsPerHour:0}});W(g),ze([...new Set(g.map(x=>x.title))].filter(Boolean));const d=[...new Set(g.map(x=>x.year))].filter(x=>x!=="Unknown").sort();Pe(d),Oe([...new Set(g.map(x=>x.venue))].filter(Boolean));const m=[...new Set(g.flatMap(x=>x.topics||[]))];Ue(m),Z(!1)}catch(s){console.error("Failed to load WMB data:",s),t&&(he(s.message),Z(!1))}})(),()=>{t=!1}},[]);const N=o.useMemo(()=>({titles:[...new Set(c.map(t=>t.title))].filter(Boolean).sort(),years:[...new Set(c.map(t=>t.year))].filter(t=>t!=="Unknown").sort(),venues:[...new Set(c.map(t=>t.venue))].filter(Boolean).sort(),topics:[...new Set(c.flatMap(t=>t.topics||[]))].sort()}),[c]),Xe=o.useMemo(()=>se===null?c:c.map(t=>{const r=se.get(t.id)||0;return{...t,mentionCount:r,mentionsPerHour:t.durationHrs>0?parseFloat((r/t.durationHrs).toFixed(1)):0,searchTerm:te}}),[c,se,te]),Ge=o.useMemo(()=>({titles:new Set(le),years:new Set(ie),venues:new Set(D),topics:new Set(be)}),[le,ie,D,be]),C=o.useMemo(()=>{const{titles:t,years:r,venues:s,topics:n}=Ge;return Xe.filter(a=>{const l=!n.size||a.topics&&a.topics.some(i=>n.has(i));return t.has(a.title)&&r.has(a.year)&&s.has(a.venue)&&l})},[Xe,Ge]),P=o.useMemo(()=>{if(!C.length)return null;const t=C.length,r=C.reduce((a,l)=>a+(l.mentionCount||0),0);let s=0,n=null;return C.forEach(a=>{(a.mentionCount||0)>s&&(s=a.mentionCount,n=a)}),{totalSermons:t,totalMentions:r,maxMentions:s,peakSermon:n,avg:t>0?(r/t).toFixed(1):"0",totalWords:C.reduce((a,l)=>a+(l.wordCount||0),0),totalDuration:C.reduce((a,l)=>a+(l.duration||0),0)}},[C]),Ae=o.useMemo(()=>C.length?[...C].sort((r,s)=>r.timestamp-s.timestamp).map(r=>({timestamp:r.timestamp,mentionCount:r.mentionCount||0,title:r.title,...r})):[],[C]),G=o.useMemo(()=>{if(!Ae.length)return[];const t=new Map;Ae.forEach(n=>{const a=new Date(n.timestamp);a.setHours(0,0,0,0),a.setDate(a.getDate()-a.getDay());const l=a.getTime();t.has(l)||t.set(l,{timestamp:l,mentionCount:0,count:0,sermons:[]});const i=t.get(l);i.mentionCount+=n.mentionCount||0,i.count++,i.sermons.push(n)});const r=Array.from(t.values()).sort((n,a)=>n.timestamp-a.timestamp),s=Ce;return r.forEach((n,a)=>{const l=Math.max(0,a-s+1),i=r.slice(l,a+1),g=i.reduce((m,x)=>m+x.mentionCount,0)/i.length,d=i.reduce((m,x)=>m+x.count,0)/i.length;n.rollingAvg=parseFloat(g.toFixed(1)),n.volumeRollingAvg=parseFloat(d.toFixed(1))}),r},[Ae,Ce]),Et=o.useMemo(()=>G.length?[G[0].timestamp,G[G.length-1].timestamp]:["auto","auto"],[G]),Rt=t=>new Date(t).toLocaleDateString(void 0,{month:"short",year:"2-digit"}),J=o.useMemo(()=>{if(!C.length)return[];const t=new Map;C.forEach(s=>{const n=s.venue||"Unknown";t.has(n)||t.set(n,{count:0,totalWords:0,years:new Set});const a=t.get(n);a.count++,a.totalWords+=s.wordCount||0,s.date&&a.years.add(s.date.slice(0,4))});const r=C.length;return Array.from(t.entries()).map(([s,n])=>{const a=Array.from(n.years).sort();return{venue:s,count:n.count,percent:(n.count/r*100).toFixed(1),totalWords:n.totalWords,dateRange:a.length>0?`${a[0]} - ${a[a.length-1]}`:"N/A"}}).sort((s,n)=>n.count-s.count)},[C]),U=o.useMemo(()=>{if(!c.length)return{venues:[],years:[],data:new Map,maxCount:0};const t=new Map,r=new Set,s=new Map;for(const i of c){const g=i.venue||"Unknown",d=i.year||"Unknown";r.add(d);const m=`${g}|${d}`;t.set(m,(t.get(m)||0)+1),s.set(g,(s.get(g)||0)+1)}const n=Array.from(s.entries()).sort((i,g)=>g[1]-i[1]).map(([i])=>i),a=Array.from(r).filter(i=>i!=="Unknown").sort();let l=0;for(const i of t.values())i>l&&(l=i);return{venues:n,years:a,data:t,maxCount:l,venueTotals:s}},[c]),Wt=o.useMemo(()=>{const t=new Map;return c.forEach(r=>{const s=r.year||"Unknown";t.has(s)||t.set(s,[]),t.get(s).push(r)}),Array.from(t.entries()).map(([r,s])=>({year:r,sermons:s.sort((n,a)=>(n.date||"").localeCompare(a.date||"")),count:s.length,totalWords:s.reduce((n,a)=>n+(a.wordCount||0),0)})).sort((r,s)=>s.year.localeCompare(r.year))},[c]),Bt=async(t,r,s=null,n={})=>{if(!t&&!s){Ne(null),ye(""),ve(""),ge([]);return}Fe.current={term:t,rawRegex:s,variations:r,...n},re(!0),Y({status:"Preparing search...",percent:0}),ge([]),await Ft(t,r,s,n)},Ft=async(t,r,s=null,n={})=>{const{wholeWords:a=!0}=n;try{const i=Object.create(null),g=t&&it(t)?t:s||t||"",d=it(g);let m;if(d){const{type:h,required:S,excluded:F,terms:H,distance:k,ordered:L,phrase:z}=d;if(h==="or"){const T=S.map($=>Q($,a));m=$=>{for(const A of F)if(Q(A,a).test($))return 0;let M=0;const R=[];for(let A=0;A<T.length;A++){T[A].lastIndex=0;const w=$.match(T[A]);if(w&&w.length>0){M+=w.length;for(const oe of w)R.push(oe.toLowerCase())}}return{count:M,matched:R}}}else if(h==="and"){const T=S.map($=>Q($,a));m=$=>{for(const A of F)if(Q(A,a).test($))return 0;let M=0;const R=[];for(let A=0;A<T.length;A++){T[A].lastIndex=0;const w=$.match(T[A]);if(!w||w.length===0)return 0;M+=w.length;for(const oe of w)R.push(oe.toLowerCase())}return{count:M,matched:R}}}else if(h==="phrase"){const T=a?new RegExp(`\\b(${z.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")})\\b`,"gi"):new RegExp(`(${z.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")})`,"gi");m=$=>{const M=$.match(T);return M?{count:M.length,matched:M.map(R=>R.toLowerCase())}:0}}else if(h==="near"||h==="onear"){const[T,$]=H,M=Q(T,a),R=Q($,a);m=A=>{const w=A.split(/\s+/);let oe=0;const Ze=[];for(let K=0;K<w.length;K++)if(M.lastIndex=0,M.test(w[K])){const Ot=L?K+1:Math.max(0,K-k),Ut=Math.min(w.length,K+k+1);for(let me=Ot;me<Ut;me++)me!==K&&(R.lastIndex=0,R.test(w[me])&&(oe++,Ze.push(w[K].toLowerCase(),w[me].toLowerCase())))}return{count:oe,matched:[...new Set(Ze)]}}}else{const T=Q(g,a);m=$=>{const M=$.match(T);return M?{count:M.length,matched:M.map(R=>R.toLowerCase())}:0}}}else if(s&&s.trim()){let h;try{h=a?new RegExp(`\\b(${s})\\b`,"gi"):new RegExp(`(${s})`,"gi")}catch(S){Y({status:`Invalid regex: ${S.message}`,percent:0,error:!0}),re(!1);return}m=S=>{h.lastIndex=0;const F=S.match(h);return F?{count:F.length,matched:F.map(H=>H.toLowerCase())}:0}}else{const h=k=>(""+k).replace(/[.*+?^${}()|[\]\\]/g,"\\$&");let S=[t].filter(Boolean);if(r){const k=Array.isArray(r)?r:r.split(",").map(L=>L.trim()).filter(Boolean);S=[...S,...k.filter(Boolean)]}if(S.length===0){re(!1);return}const F=S.map(h).join("|"),H=a?new RegExp(`\\b(${F})\\b`,"gi"):new RegExp(`(${F})`,"gi");m=k=>{H.lastIndex=0;const L=k.match(H);return L?{count:L.length,matched:L.map(z=>z.toLowerCase())}:0}}const x=Object.create(null),O=ue||0;if(!O||O===0){Y({status:"No data available",percent:0,error:!0}),re(!1);return}Y({status:"Searching transcripts...",percent:10});let Le=0;for(let h=0;h<O;h+=50){const S=[];for(let k=h;k<Math.min(h+50,O);k++)S.push(fetch(`${v}text_chunk_${k}.json`).then(L=>L.ok?L.json():[]).catch(()=>[]));const F=await Promise.all(S);for(const k of F){for(const L of k)try{const z=m(L.text);if(z&&z.count>0&&(x[L.id]=(x[L.id]||0)+z.count,z.matched))for(const T of z.matched)i[T]=(i[T]||0)+1}catch{}Le++}const H=Math.round(Le/O*100);Y({status:"Searching transcripts...",percent:10+Math.round(H*.85),detail:`${Le} of ${O} chunks`}),await new Promise(k=>setTimeout(k,5))}Y({status:"Counting matches...",percent:95});const Qe=new Map;for(const h in x)Object.hasOwn(x,h)&&Qe.set(h,x[h]);Ne(Qe),ye(t),ve(s&&s.trim()?s:g);const De=[];for(const h in i)Object.hasOwn(i,h)&&De.push({term:h,count:i[h]});De.sort((h,S)=>S.count-h.count),ge(De.slice(0,50)),re(!1),Y({status:"Done!",percent:100})}catch(l){console.error("Search failed",l),re(!1),Y({status:"Search failed",percent:0,error:!0})}},Je=o.useMemo(()=>{let t=[...C];if(E.date&&(t=t.filter(r=>r.date.includes(E.date))),E.venue&&(t=t.filter(r=>r.venue&&r.venue.toLowerCase().includes(E.venue.toLowerCase()))),E.title&&(t=t.filter(r=>r.title.toLowerCase().includes(E.title.toLowerCase()))),E.search){const r=E.search.toLowerCase();t=t.filter(s=>(s.title||"").toLowerCase().includes(r)||(s.venue||"").toLowerCase().includes(r)||(s.location||"").toLowerCase().includes(r)||(s.date||"").toLowerCase().includes(r))}return X.key&&t.sort((r,s)=>{let n=r[X.key],a=s[X.key];return typeof n=="string"&&(n=n.toLowerCase()),typeof a=="string"&&(a=a.toLowerCase()),n<a?X.direction==="asc"?-1:1:n>a?X.direction==="asc"?1:-1:0}),t},[C,E,X]),zt=()=>{ce(N.titles),ae(N.years),q(N.venues),Ye(N.topics)},Pt=le.length!==N.titles.length||ie.length!==N.years.length||D.length!==N.venues.length||be.length!==N.topics.length;return B?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-amber-50 to-orange-100",children:e.jsxs("div",{className:"text-center p-8 bg-white rounded-2xl shadow-xl border border-amber-200 max-w-md w-full mx-4",children:[e.jsx("div",{className:"w-16 h-16 border-4 border-amber-200 border-t-amber-600 rounded-full animate-spin mx-auto mb-6"}),e.jsx("h2",{className:"text-2xl font-bold text-amber-800 mb-2",children:"Loading Branham Archive"}),e.jsx("p",{className:"text-amber-600 text-sm",children:"1,181 sermons â€¢ 17.5M words â€¢ 1947-1965"})]})}):ee?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-red-50 p-4",children:e.jsxs("div",{className:"bg-white p-8 rounded-xl shadow-xl border border-red-200 max-w-lg w-full text-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-red-600 mb-4",children:"Failed to Load"}),e.jsx("p",{className:"text-gray-600 mb-4",children:ee}),e.jsx("button",{onClick:()=>window.location.reload(),className:"bg-red-600 text-white font-bold py-2 px-6 rounded hover:bg-red-700 transition",children:"Retry"})]})}):e.jsx(Zt,{children:e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-amber-50 via-orange-50 to-yellow-50",children:[e.jsx("div",{className:"bg-gradient-to-r from-amber-700 to-orange-600 text-white shadow-lg sticky top-0 z-40",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-3 flex flex-col md:flex-row justify-between items-start md:items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[e.jsx("div",{className:"bg-white/20 backdrop-blur p-2 rounded-lg shadow-lg flex-shrink-0",children:e.jsx(u,{name:"book",className:"text-white"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("h1",{className:"font-bold text-base md:text-lg text-white leading-tight truncate",children:"William Branham Sermon Archive"}),e.jsxs("p",{className:"text-xs text-amber-100 truncate",children:[Re," â€¢ ",f.toLocaleString()," sermons â€¢ ",(We/1e6).toFixed(1),"M words"]})]})]}),e.jsxs("div",{className:"flex flex-col md:flex-row items-stretch md:items-center gap-3 md:gap-4 w-full md:w-auto",children:[Ee&&e.jsxs("div",{className:"text-xs text-amber-200 text-center md:text-right",children:["Data: ",Ee]}),e.jsx("div",{className:"flex bg-white/10 backdrop-blur p-1 rounded-lg w-full md:w-auto",children:["dashboard","data","about"].map(t=>e.jsx("button",{onClick:()=>yt(t),className:`px-3 md:px-4 py-1.5 rounded-md text-xs md:text-sm font-medium transition capitalize flex-1 md:flex-none ${de===t?"bg-white text-amber-700 shadow-sm":"text-amber-100 hover:text-white hover:bg-white/10"}`,children:t},t))}),y&&e.jsx("button",{onClick:y,className:"px-3 py-1.5 bg-white/10 hover:bg-white/20 rounded-md text-xs font-medium text-amber-100 hover:text-white transition",children:"â† Back to Main"})]})]})}),e.jsxs("div",{className:"bg-amber-100 border-b border-amber-200 text-amber-800 text-xs text-center py-2 px-4",children:[e.jsx("span",{className:"font-bold",children:"Source:"})," Transcripts from ",e.jsx("a",{href:"https://www.livingwordbroadcast.org/wbtextindex/?lang=en",target:"_blank",rel:"noopener noreferrer",className:"text-amber-700 hover:text-amber-900 underline",children:"Living Word Broadcast"})," â€¢ Click any sermon to read the full transcript"]}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-6",children:[de==="dashboard"&&e.jsxs("div",{className:"bg-white p-4 rounded-xl border shadow-sm mb-6",children:[e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-2 mb-3",children:[e.jsxs("h3",{className:"font-bold text-gray-800 flex items-center gap-2 text-sm",children:[e.jsx(u,{name:"filter",size:16})," Filters"]}),Pt&&e.jsx("button",{onClick:zt,className:"text-xs text-amber-600 hover:text-amber-800 font-medium",children:"Clear all filters"})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:[e.jsx(je,{label:"Years",options:N.years,selected:ie,onChange:ae}),e.jsx(je,{label:"Venues",options:N.venues,selected:D,onChange:q}),e.jsx(je,{label:"Topics",options:N.topics,selected:be,onChange:Ye}),e.jsx(je,{label:"Titles",options:N.titles,selected:le,onChange:ce})]})]}),de==="dashboard"&&P&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-white rounded-xl border shadow-sm mb-6",children:[e.jsxs("button",{onClick:()=>Ct(!I),className:`w-full flex items-center justify-between p-4 transition-colors ${I?"bg-gradient-to-r from-amber-50 to-orange-50 hover:from-amber-100 hover:to-orange-100":"hover:bg-gray-50"}`,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(u,{name:I?"chevronRight":"chevronDown",size:18,className:I?"text-amber-600":"text-gray-500"}),e.jsxs("h3",{className:`font-bold ${I?"text-amber-800":"text-gray-800"}`,children:[e.jsx(u,{name:"barChart",className:"inline mr-1",size:16})," Sermons by Venue"]}),e.jsxs("span",{className:"text-sm text-gray-500",children:["(",J.length," venues)"]})]}),e.jsx("span",{className:`text-sm font-medium ${I?"text-amber-600 bg-amber-100 px-3 py-1 rounded-full":"text-xs text-gray-400"}`,children:I?"â–¶ Click to view":"Click to collapse"})]}),!I&&e.jsxs("div",{className:"p-4 pt-2",children:[e.jsxs("div",{className:"flex gap-2 mb-3",children:[e.jsx("button",{onClick:()=>_e("bars"),className:`px-3 py-1.5 text-sm font-medium rounded-lg transition-colors ${fe==="bars"?"bg-amber-600 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:"ðŸ“Š Bar Chart"}),e.jsx("button",{onClick:()=>_e("heatmap"),className:`px-3 py-1.5 text-sm font-medium rounded-lg transition-colors ${fe==="heatmap"?"bg-amber-600 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:"ðŸ—“ï¸ Venue Ã— Year"})]}),fe==="bars"&&J.length>0&&(()=>{const t=Math.max(...J.map(n=>n.count)),r=Math.ceil(t/50)*50,s=[];for(let n=0;n<=r;n+=50)s.push(n);return e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-xs text-gray-500 mb-3",children:"Click a bar to filter sermons by that venue. Darker bars = more sermons."}),e.jsx("div",{style:{height:Math.max(400,J.length*20)},children:e.jsx(et,{width:"100%",height:"100%",children:e.jsxs(Yt,{data:J,layout:"vertical",margin:{top:10,right:30,left:5,bottom:5},barSize:14,children:[e.jsx(tt,{strokeDasharray:"3 3",horizontal:!1}),e.jsx(st,{type:"number",tickFormatter:n=>n.toLocaleString(),orientation:"top",axisLine:!1,tickLine:!1,tick:{fontSize:10},ticks:s,domain:[0,r]}),e.jsx(rt,{type:"category",dataKey:"venue",width:typeof window<"u"&&window.innerWidth<640?120:200,tick:{fontSize:typeof window<"u"&&window.innerWidth<640?8:10},interval:0}),e.jsx(at,{content:({active:n,payload:a})=>{if(!n||!a||!a.length)return null;const l=a[0].payload;return e.jsxs("div",{className:"bg-white border rounded-lg shadow-lg p-3 text-sm max-w-xs",children:[e.jsx("p",{className:"font-bold text-gray-800 mb-2",children:l.venue}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("p",{className:"text-amber-600",children:["ðŸ“Š Sermons: ",e.jsx("span",{className:"font-semibold",children:l.count.toLocaleString()})," ",e.jsxs("span",{className:"text-gray-400",children:["(",l.percent,"%)"]})]}),e.jsxs("p",{className:"text-gray-600",children:["ðŸ“… Years: ",l.dateRange]}),e.jsxs("p",{className:"text-blue-600",children:["ðŸ“ Words: ",e.jsx("span",{className:"font-semibold",children:l.totalWords.toLocaleString()})]})]})]})}}),e.jsx(Vt,{dataKey:"count",radius:[0,4,4,0],children:J.map((n,a)=>{const l=1-a/(J.length-1||1),i=Math.round(254+-74*l),g=Math.round(243+-160*l),d=Math.round(199+-190*l),m=`rgb(${i},${g},${d})`,x=D.length===1&&D[0]===n.venue;return e.jsx(_t,{fill:x?"#d97706":m,stroke:x?"#92400e":"none",strokeWidth:x?2:0,style:{cursor:"pointer"},onClick:()=>{D.length===1&&D[0]===n.venue?q([]):q([n.venue])}},n.venue)})})]})})})]})})(),fe==="heatmap"&&U&&e.jsxs("div",{className:"overflow-x-auto",children:[e.jsx("p",{className:"text-xs text-gray-500 mb-3",children:"Sermon distribution by venue and year. Darker = more sermons. Click to filter."}),e.jsxs("div",{className:"grid gap-px bg-gray-200",style:{gridTemplateColumns:`200px repeat(${U.years.length}, minmax(32px, 1fr))`,minWidth:`${200+U.years.length*36}px`},children:[e.jsx("div",{className:"bg-gray-50 p-1.5 text-xs font-bold text-gray-700 sticky left-0 z-10",children:"Venue"}),U.years.map(t=>e.jsx("div",{className:"bg-gray-50 p-1.5 text-xs font-bold text-gray-700 text-center",children:t.toString().slice(-2)},t)),U.venues.map((t,r)=>e.jsxs(It.Fragment,{children:[e.jsx("div",{className:`bg-white p-1.5 text-xs truncate sticky left-0 z-10 cursor-pointer hover:bg-amber-50 ${D.includes(t)?"bg-amber-100 font-semibold":""}`,title:`${t} (${U.venueTotals.get(t)||0} sermons)`,onClick:()=>{D.includes(t)?q(D.filter(s=>s!==t)):q([...D,t])},children:t}),U.years.map(s=>{const n=U.data.get(`${t}|${s}`)||0,a=n>0?Math.min(.15+n/U.maxCount*.85,1):0;return e.jsx("div",{className:"p-1.5 text-center text-xs cursor-pointer transition-colors hover:ring-1 hover:ring-amber-400",style:{backgroundColor:n>0?`rgba(217, 119, 6, ${a})`:"white",color:a>.5?"white":n>0?"#92400e":"#9ca3af"},title:`${t} (${s}): ${n} sermon${n!==1?"s":""}`,onClick:()=>{q([t]),ae([s.toString()])},children:n>0?n:"Â·"},`${t}-${s}`)})]},t))]}),e.jsxs("div",{className:"flex items-center justify-end gap-2 mt-3 text-xs text-gray-500",children:[e.jsx("span",{children:"Fewer"}),e.jsx("div",{className:"flex",children:[.15,.35,.55,.75,.95].map((t,r)=>e.jsx("div",{className:"w-5 h-4",style:{backgroundColor:`rgba(217, 119, 6, ${t})`}},r))}),e.jsx("span",{children:"More sermons"})]})]})]})]}),e.jsx(Ht,{onAnalyze:Bt,isAnalyzing:Be,progress:jt,initialTerm:"",initialVariations:"",matchedTerms:ft,totalTranscripts:f,defaultTerm:"",defaultRegex:""}),e.jsxs("div",{className:"flex flex-wrap gap-2 mb-6",children:[e.jsx("span",{className:"text-sm text-gray-500 font-medium self-center mr-2",children:"Featured Series:"}),e.jsxs("button",{onClick:()=>{const t=["63-0317E","63-0318","63-0319","63-0320","63-0321","63-0322","63-0323","63-0324E"],r=c.filter(s=>t.some(n=>s.dateCode===n||s.id?.startsWith(n))).map(s=>s.title);r.length>0&&(ce(r),ae(["1963"]))},className:"px-3 py-1.5 bg-amber-100 hover:bg-amber-200 text-amber-800 rounded-lg text-sm font-medium transition flex items-center gap-1.5",children:[e.jsx(u,{name:"book",size:14})," The Seven Seals"]}),e.jsxs("button",{onClick:()=>{const t=["60-1205","60-1206","60-1207","60-1208","60-1209","60-1210","60-1211E"],r=c.filter(s=>t.some(n=>s.dateCode===n||s.id?.startsWith(n))).map(s=>s.title);r.length>0&&(ce(r),ae(["1960"]))},className:"px-3 py-1.5 bg-indigo-100 hover:bg-indigo-200 text-indigo-800 rounded-lg text-sm font-medium transition flex items-center gap-1.5",children:[e.jsx(u,{name:"book",size:14})," The Seven Church Ages"]}),(le.length!==N.titles.length||ie.length!==N.years.length)&&e.jsxs("button",{onClick:()=>{ce(N.titles),ae(N.years)},className:"px-3 py-1.5 bg-gray-100 hover:bg-gray-200 text-gray-600 rounded-lg text-sm font-medium transition flex items-center gap-1.5",children:[e.jsx(u,{name:"x",size:14})," Show All Sermons"]})]}),se&&P.totalMentions===0&&!Be&&e.jsxs("div",{className:"bg-amber-50 border border-amber-200 rounded-xl p-4 mb-6 flex items-start gap-3",children:[e.jsx("div",{className:"flex-shrink-0 w-10 h-10 bg-amber-100 rounded-full flex items-center justify-center",children:e.jsx(u,{name:"alertCircle",size:20,className:"text-amber-600"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-bold text-amber-800 text-sm",children:"No Results Found"}),e.jsxs("p",{className:"text-amber-700 text-xs mt-1",children:['Your search for "',e.jsx("span",{className:"font-semibold",children:j}),'" did not match any transcripts.']})]})]}),e.jsxs("div",{className:"grid grid-cols-3 md:grid-cols-5 gap-1.5 sm:gap-2 mb-6",children:[e.jsx(xe,{title:"Sermons",value:P.totalSermons.toLocaleString(),icon:"book",color:"amber",sub:`of ${f.toLocaleString()} total`}),j&&e.jsx(xe,{title:`"${j}" Matches`,value:P.totalMentions.toLocaleString(),icon:"search",color:P.totalMentions===0?"red":"green",sub:"in filtered results"}),e.jsx(xe,{title:"Total Words",value:`${(P.totalWords/1e6).toFixed(1)}M`,icon:"fileText",color:"blue",sub:"in filtered sermons"}),e.jsx(xe,{title:"Total Hours",value:Math.round(P.totalDuration/60).toLocaleString(),icon:"clock",color:"purple",sub:"of preaching"}),P.peakSermon&&j&&e.jsx(xe,{title:"Peak Mentions",value:P.maxMentions,icon:"activity",color:"orange",sub:"Click to view",onClick:()=>{V({...P.peakSermon,searchTerm:te||j}),_(0)}})]}),e.jsxs("div",{className:"bg-white p-3 sm:p-6 rounded-xl border shadow-sm h-[350px] sm:h-[450px] mb-6 relative",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-2 mb-4",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"font-bold text-gray-800 flex items-center gap-2 text-sm sm:text-base",children:[e.jsx(u,{name:"activity"})," Sermon Timeline (1947-1965)"]}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[j?`Showing "${j}" mentions over time`:"Sermon distribution over time"," â€¢ Click a point to browse"]})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[j&&e.jsxs("button",{onClick:()=>{ye(""),ve(""),Ne(null),ge([])},className:"text-xs bg-red-100 text-red-700 hover:bg-red-200 px-3 py-1.5 rounded-lg font-medium flex items-center gap-1 transition-colors",children:[e.jsx(u,{name:"x",size:12})," Clear Search"]}),e.jsx("span",{className:"text-xs text-gray-500",children:"Smoothing:"}),e.jsx("div",{className:"flex bg-gray-100 rounded-lg p-1",children:[{w:4,l:"1 Mo"},{w:12,l:"3 Mo"},{w:26,l:"6 Mo"}].map(({w:t,l:r})=>e.jsx("button",{onClick:()=>wt(t),className:`px-2 py-1 text-xs font-medium rounded ${Ce===t?"bg-white shadow text-amber-600":"text-gray-500"}`,children:r},t))})]})]}),e.jsx(et,{width:"100%",height:"85%",children:e.jsxs(Kt,{data:G,onClick:t=>{if(t&&t.activePayload&&t.activePayload[0]){const r=G.find(s=>s.timestamp===t.activePayload[0].payload.timestamp);r&&($e(r),Lt({x:t.chartX||200,y:t.chartY||100}))}},children:[e.jsx(tt,{strokeDasharray:"3 3",vertical:!1,stroke:"#e5e7eb"}),e.jsx(st,{dataKey:"timestamp",type:"number",scale:"time",domain:Et,tickFormatter:Rt,tick:{fontSize:10},minTickGap:80}),e.jsx(rt,{tick:{fontSize:10},label:{value:j?"Mentions":"Sermons",angle:-90,position:"insideLeft",style:{textAnchor:"middle",fontSize:11,fill:"#6b7280"}}}),e.jsx(at,{content:({active:t,payload:r})=>{if(ne||!t||!r||!r.length)return null;const s=r[0].payload,n=`Week of ${new Date(s.timestamp).toLocaleDateString(void 0,{month:"short",day:"numeric",year:"numeric"})}`;return e.jsxs("div",{className:"bg-white p-3 rounded-lg shadow-lg text-sm border border-gray-200",children:[e.jsx("div",{className:"font-bold text-gray-900",children:n}),e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[j?e.jsxs(e.Fragment,{children:[s.mentionCount," mentions â€¢ "]}):null,s.count," sermon",s.count!==1?"s":""]}),e.jsx("div",{className:"mt-2 text-amber-600 text-xs font-medium",children:"Click to browse â†’"})]})}}),e.jsx(qt,{wrapperStyle:{fontSize:"11px",paddingTop:"8px"}}),j?e.jsxs(e.Fragment,{children:[e.jsx(nt,{type:"monotone",dataKey:"mentionCount",name:"Mentions",stroke:"#f59e0b",fill:"#fcd34d",fillOpacity:.6,isAnimationActive:!1,cursor:"pointer"}),e.jsx(ot,{type:"monotone",dataKey:"rollingAvg",name:"Trend",stroke:"#d97706",strokeWidth:3,dot:!1,isAnimationActive:!1})]}):e.jsxs(e.Fragment,{children:[e.jsx(nt,{type:"monotone",dataKey:"count",name:"Sermons",stroke:"#f59e0b",fill:"#fcd34d",fillOpacity:.6,isAnimationActive:!1,cursor:"pointer"}),e.jsx(ot,{type:"monotone",dataKey:"volumeRollingAvg",name:"Trend",stroke:"#d97706",strokeWidth:3,dot:!1,isAnimationActive:!1})]})]})}),ne&&e.jsxs("div",{ref:Dt,className:"fixed sm:absolute inset-x-2 sm:inset-x-auto bottom-2 sm:bottom-auto bg-white rounded-xl shadow-2xl border border-gray-200 sm:w-96 max-h-[60vh] sm:max-h-[400px] flex flex-col z-50",style:{left:typeof window<"u"&&window.innerWidth>=640?Math.min(Math.max(16,qe.x-150),window.innerWidth-450):void 0,top:typeof window<"u"&&window.innerWidth>=640?Math.max(60,qe.y+20):void 0},children:[e.jsx("div",{className:"p-4 border-b border-gray-100",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"font-bold text-gray-900",children:["Week of ",new Date(ne.timestamp).toLocaleDateString(void 0,{month:"short",day:"numeric",year:"numeric"})]}),e.jsxs("div",{className:"text-sm text-gray-500 mt-1",children:[ne.sermons?.length||0," sermon",(ne.sermons?.length||0)!==1?"s":""]})]}),e.jsx("button",{onClick:()=>$e(null),className:"p-1 hover:bg-gray-100 rounded-full",children:e.jsx(u,{name:"x"})})]})}),e.jsx("div",{className:"text-xs font-medium text-gray-600 px-4 pt-3 pb-2",children:"Click a sermon to view transcript:"}),e.jsx("div",{className:"flex-1 overflow-auto px-3 pb-3",children:e.jsx("div",{className:"space-y-2",children:[...ne.sermons||[]].sort((t,r)=>(r.mentionCount||0)-(t.mentionCount||0)).map((t,r)=>e.jsxs("button",{onClick:()=>{V({...t,searchTerm:te||j}),_(0),$e(null)},className:"w-full text-left p-3 bg-amber-50 rounded-lg border border-amber-200 hover:bg-amber-100 hover:border-amber-300 transition-all group",children:[e.jsx("div",{className:"font-medium text-gray-900 group-hover:text-amber-700 line-clamp-2",children:t.title||"Untitled"}),e.jsxs("div",{className:"flex justify-between items-center mt-2 text-xs",children:[e.jsx("span",{className:"text-gray-500",children:t.venue||"Unknown venue"}),e.jsx("span",{className:"text-gray-400",children:new Date(t.timestamp).toLocaleDateString()})]}),j&&t.mentionCount>0&&e.jsxs("div",{className:"mt-1 text-xs text-amber-600 font-medium",children:[t.mentionCount," mentions"]})]},t.id||r))})})]})]}),e.jsxs("div",{className:"bg-white rounded-xl border shadow-sm mb-8 p-4 sm:p-6 overflow-x-auto w-full",children:[e.jsxs("div",{className:"flex flex-col gap-3 mb-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-2",children:[e.jsxs("h3",{className:"font-bold text-gray-800",children:["Sermon List (",Je.length.toLocaleString(),")"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[j&&e.jsxs("div",{className:"text-sm bg-amber-50 text-amber-700 px-3 py-1 rounded font-medium",children:["Searching for: ",e.jsx("span",{className:"font-semibold",children:j})]}),e.jsxs("a",{href:"https://www.livingwordbroadcast.org/wbtextindex/?lang=en",target:"_blank",rel:"noopener noreferrer",className:"text-xs bg-amber-100 text-amber-700 hover:bg-amber-200 px-3 py-1.5 rounded font-medium flex items-center gap-1",children:[e.jsx(u,{name:"externalLink",size:12})," Browse LWB Transcripts"]})]})]}),e.jsxs("div",{className:"relative max-w-md",children:[e.jsx(u,{name:"search",size:14,className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search table by title, venue, date...",value:E.search||"",onChange:t=>Te(r=>({...r,search:t.target.value})),className:"w-full pl-9 pr-8 py-2 text-sm border rounded-lg focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-transparent"}),E.search&&e.jsx("button",{onClick:()=>Te(t=>({...t,search:""})),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",children:e.jsx(u,{name:"x",size:14})})]})]}),e.jsx(Xt,{columns:[{key:"date",label:"Date",width:"100px",filterKey:"date",filterPlaceholder:"YYYY",render:t=>t.date},{key:"title",label:"Title",width:"1fr",filterKey:"title",render:t=>e.jsx("span",{className:"text-sm font-medium text-gray-900 truncate block",title:t.title,children:t.title})},{key:"venue",label:"Venue",width:"200px",filterKey:"venue",hideOnMobile:!0,render:t=>e.jsx("span",{className:"text-xs text-gray-600 truncate",children:t.venue||"â€”"})},{key:"location",label:"Location",width:"140px",hideOnMobile:!0,render:t=>e.jsx("span",{className:"text-xs text-gray-500",children:t.location||"â€”"})},...j?[{key:"mentionCount",label:"Mentions",width:"80px",render:t=>e.jsx("span",{className:`text-xs font-bold ${t.mentionCount>0?"text-amber-600":"text-gray-400"}`,children:t.mentionCount||0})}]:[],{key:"wordCount",label:"Words",width:"90px",hideOnMobile:!0,render:t=>e.jsx("span",{className:"text-xs text-gray-500",children:t.wordCount?.toLocaleString()||"â€”"})},{key:"download",label:"Download",width:"90px",render:t=>t.path?e.jsxs("a",{href:`/wmbmentions.github.io/${lt(t.path)}`,download:!0,onClick:s=>s.stopPropagation(),className:"text-xs text-blue-600 hover:text-blue-800 font-medium flex items-center gap-1",children:[e.jsx(u,{name:"download",size:12})," TXT"]}):"â€”"}],data:Je,filters:E,onFilterChange:(t,r)=>Te(s=>({...s,[t]:r})),sortConfig:X,onSort:t=>Me(r=>({key:t,direction:r.key===t&&r.direction==="asc"?"desc":"asc"})),onRowClick:t=>{V({...t,searchTerm:te||j}),_(0)},rowHeight:48})]})]}),de==="data"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-xl border shadow-sm p-6",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-800 mb-4",children:"Archive Statistics"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-amber-50 p-4 rounded-lg",children:[e.jsx("div",{className:"text-3xl font-bold text-amber-700",children:f.toLocaleString()}),e.jsx("div",{className:"text-sm text-amber-600",children:"Total Sermons"})]}),e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[e.jsxs("div",{className:"text-3xl font-bold text-blue-700",children:[(We/1e6).toFixed(1),"M"]}),e.jsx("div",{className:"text-sm text-blue-600",children:"Total Words"})]}),e.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg",children:[e.jsx("div",{className:"text-3xl font-bold text-purple-700",children:Math.round(xt/60).toLocaleString()}),e.jsx("div",{className:"text-sm text-purple-600",children:"Hours of Preaching"})]}),e.jsxs("div",{className:"bg-green-50 p-4 rounded-lg",children:[e.jsx("div",{className:"text-3xl font-bold text-green-700",children:pt.length}),e.jsx("div",{className:"text-sm text-green-600",children:"Unique Venues"})]})]}),e.jsx("h3",{className:"text-lg font-bold text-gray-800 mb-3",children:"Featured Sermon Series"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 mb-6",children:Object.entries(ke).map(([t,r])=>{const s=At(t),n=He.has(t),a={amber:{bg:"bg-amber-50",border:"border-amber-200",header:"bg-amber-100",text:"text-amber-800",badge:"bg-amber-600"},indigo:{bg:"bg-indigo-50",border:"border-indigo-200",header:"bg-indigo-100",text:"text-indigo-800",badge:"bg-indigo-600"}}[r.color]||{bg:"bg-gray-50",border:"border-gray-200",header:"bg-gray-100",text:"text-gray-800",badge:"bg-gray-600"};return e.jsxs("div",{className:`rounded-lg border ${a.border} overflow-hidden`,children:[e.jsxs("button",{onClick:()=>Ke(l=>{const i=new Set(l);return i.has(t)?i.delete(t):i.add(t),i}),className:`w-full p-3 ${a.header} flex items-center justify-between transition hover:opacity-90`,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(u,{name:"book",size:18,className:a.text}),e.jsx("span",{className:`font-bold ${a.text}`,children:t}),e.jsxs("span",{className:`text-xs px-2 py-0.5 rounded-full text-white ${a.badge}`,children:[s.length," sermons"]})]}),e.jsx(u,{name:n?"chevronUp":"chevronDown",size:18,className:a.text})]}),n&&e.jsxs("div",{className:`${a.bg} p-3`,children:[e.jsx("p",{className:"text-xs text-gray-500 mb-2",children:r.description}),e.jsx("div",{className:"space-y-1",children:s.map(l=>e.jsxs("button",{onClick:()=>{V(l),_(0)},className:"w-full text-left p-2 bg-white rounded border hover:bg-gray-50 transition flex justify-between items-center group",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"font-medium text-gray-800 text-sm truncate",children:l.title}),e.jsx("div",{className:"text-xs text-gray-500",children:l.date})]}),e.jsx(u,{name:"chevronRight",size:14,className:"text-gray-400 group-hover:text-gray-600 flex-shrink-0 ml-2"})]},l.id))})]})]},t)})}),e.jsx("h3",{className:"text-lg font-bold text-gray-800 mb-3",children:"Top Topics"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-2",children:Object.entries(ut).slice(0,12).map(([t,r])=>{const s=He.has(`topic-${t}`),n=s?c.filter(a=>a.topics&&a.topics.includes(t)).sort((a,l)=>(a.date||"").localeCompare(l.date||"")):[];return e.jsxs("div",{className:"border rounded-lg overflow-hidden",children:[e.jsxs("button",{onClick:()=>Ke(a=>{const l=new Set(a),i=`topic-${t}`;return l.has(i)?l.delete(i):l.add(i),l}),className:`w-full p-3 flex justify-between items-center transition ${s?"bg-gray-100":"bg-gray-50 hover:bg-gray-100"}`,children:[e.jsx("span",{className:"font-medium text-gray-700",children:t}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-sm text-gray-500",children:[r," sermons"]}),e.jsx(u,{name:s?"chevronUp":"chevronDown",size:14,className:"text-gray-400"})]})]}),s&&e.jsxs("div",{className:"bg-white border-t max-h-80 overflow-y-auto",children:[e.jsx("div",{className:"sticky top-0 bg-gray-50 p-2 border-b flex justify-between items-center",children:e.jsxs("span",{className:"text-xs text-gray-500",children:[n.length," sermons"]})}),e.jsx("div",{className:"p-2",children:n.map(a=>e.jsxs("div",{className:"flex items-center gap-1 hover:bg-gray-50 rounded transition",children:[e.jsxs("button",{onClick:()=>{V(a),_(0)},className:"flex-1 text-left p-2 flex justify-between items-center text-sm min-w-0",children:[e.jsx("span",{className:"truncate text-gray-800",children:a.title}),e.jsx("span",{className:"text-xs text-gray-500 ml-2 flex-shrink-0",children:a.date})]}),e.jsx("a",{href:a.lwbUrl||"https://www.livingwordbroadcast.org/wbtextindex/?lang=en",target:"_blank",rel:"noopener noreferrer",title:"Download from Living Word Broadcast",className:"p-2 text-gray-400 hover:text-amber-600 flex-shrink-0",children:e.jsx(u,{name:"download",size:14})})]},a.id))})]})]},t)})})]}),e.jsxs("div",{className:"bg-white rounded-xl border shadow-sm p-6",children:[e.jsxs("h2",{className:"text-xl font-bold text-gray-800 mb-4",children:[e.jsx(u,{name:"calendar",className:"inline mr-2",size:20}),"All Transcripts by Year"]}),e.jsx("p",{className:"text-sm text-gray-500 mb-4",children:"Click a year to expand and see all sermons. Click a sermon to view its full transcript."}),e.jsx("div",{className:"space-y-2",children:Wt.map(({year:t,sermons:r,count:s,totalWords:n})=>{const a=St.has(t),l=Tt[t]||"",i=Mt[t]||{key:"date",direction:"asc"},g=r.filter(d=>{if(!l)return!0;const m=l.toLowerCase();return(d.title||"").toLowerCase().includes(m)||(d.venue||"").toLowerCase().includes(m)||(d.date||"").toLowerCase().includes(m)}).sort((d,m)=>{const x=i.direction==="asc"?1:-1;return i.key==="date"?x*(d.date||"").localeCompare(m.date||""):i.key==="title"?x*(d.title||"").localeCompare(m.title||""):i.key==="venue"?x*(d.venue||"").localeCompare(m.venue||""):0});return e.jsxs("div",{className:"border rounded-lg overflow-hidden",children:[e.jsxs("button",{onClick:()=>{kt(d=>{const m=new Set(d);return m.has(t)?m.delete(t):m.add(t),m})},className:`w-full flex items-center justify-between p-4 transition-colors ${a?"bg-amber-100":"bg-amber-50 hover:bg-amber-100"}`,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(u,{name:a?"chevronDown":"chevronRight",size:18,className:"text-amber-600"}),e.jsx("span",{className:"text-lg font-bold text-amber-800",children:t}),e.jsxs("span",{className:"text-sm text-amber-600",children:["(",s," sermons)"]})]}),e.jsxs("div",{className:"text-sm text-amber-700",children:[(n/1e3).toFixed(0),"K words"]})]}),a&&e.jsxs("div",{className:"bg-white border-t p-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 mb-3",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(u,{name:"search",size:14,className:"absolute left-2 top-1/2 -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search sermons by title, venue, or date...",value:l,onChange:d=>Ie(m=>({...m,[t]:d.target.value})),className:"w-full pl-7 pr-3 py-1.5 text-sm border rounded focus:outline-none focus:ring-1 focus:ring-amber-500"}),l&&e.jsx("button",{onClick:()=>Ie(d=>({...d,[t]:""})),className:"absolute right-2 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",children:e.jsx(u,{name:"x",size:12})})]}),e.jsxs("div",{className:"flex gap-1 text-xs",children:[e.jsx("span",{className:"text-gray-500 self-center mr-1",children:"Sort:"}),["date","title","venue"].map(d=>e.jsxs("button",{onClick:()=>$t(m=>({...m,[t]:{key:d,direction:m[t]?.key===d&&m[t]?.direction==="asc"?"desc":"asc"}})),className:`px-2 py-1 rounded ${i.key===d?"bg-amber-100 text-amber-700":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:[d.charAt(0).toUpperCase()+d.slice(1),i.key===d&&(i.direction==="asc"?" â†‘":" â†“")]},d))]})]}),e.jsxs("div",{className:"max-h-96 overflow-y-auto overflow-x-auto",children:[e.jsxs("table",{className:"w-full text-sm min-w-[700px]",children:[e.jsx("thead",{className:"bg-gray-50 sticky top-0",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left p-2 font-medium text-gray-600",children:"Date"}),e.jsx("th",{className:"text-left p-2 font-medium text-gray-600",children:"Title"}),e.jsx("th",{className:"text-left p-2 font-medium text-gray-600 hidden sm:table-cell",children:"Venue"}),e.jsx("th",{className:"text-right p-2 font-medium text-gray-600 hidden md:table-cell",children:"Words"}),e.jsx("th",{className:"text-center p-2 font-medium text-gray-600",children:"Source"}),e.jsx("th",{className:"text-center p-2 font-medium text-gray-600",children:"Download"})]})}),e.jsx("tbody",{children:g.map((d,m)=>e.jsxs("tr",{onClick:()=>{V(d),_(0)},className:"border-t cursor-pointer hover:bg-amber-50 transition-colors",children:[e.jsx("td",{className:"p-2 text-gray-600 whitespace-nowrap",children:d.date}),e.jsx("td",{className:"p-2 font-medium text-gray-800",children:d.title}),e.jsx("td",{className:"p-2 text-gray-600 hidden sm:table-cell",children:d.venue}),e.jsx("td",{className:"p-2 text-gray-500 text-right hidden md:table-cell",children:d.wordCount?.toLocaleString()}),e.jsx("td",{className:"p-2 text-center",children:e.jsx("a",{href:"https://www.livingwordbroadcast.org/wbtextindex/?lang=en",target:"_blank",rel:"noopener noreferrer",onClick:x=>x.stopPropagation(),className:"text-xs text-amber-600 hover:text-amber-800 font-medium",children:"LWB â†—"})}),e.jsx("td",{className:"p-2 text-center",children:d.path&&e.jsxs("a",{href:`/wmbmentions.github.io/${lt(d.path)}`,download:!0,onClick:x=>x.stopPropagation(),className:"text-xs text-blue-600 hover:text-blue-800 font-medium inline-flex items-center gap-1",children:[e.jsx(u,{name:"download",size:12})," TXT"]})})]},d.id||m))})]}),g.length===0&&e.jsx("div",{className:"text-center py-4 text-gray-500",children:"No sermons match your search."})]}),e.jsxs("div",{className:"text-xs text-gray-500 mt-2 pt-2 border-t",children:["Showing ",g.length," of ",s," sermons"]})]})]},t)})})]})]}),de==="about"&&e.jsxs("div",{className:"bg-white rounded-xl border shadow-sm p-6",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-800 mb-4",children:"About This Archive"}),e.jsxs("div",{className:"prose prose-sm max-w-none text-gray-600",children:[e.jsxs("p",{children:["This searchable archive contains ",e.jsxs("strong",{children:[f.toLocaleString()," sermon transcripts"]})," from William Branham's ministry spanning ",e.jsx("strong",{children:Re}),"."]}),e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mt-6 mb-2",children:"Features"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Full-text search"})," with regex and boolean operators (AND, OR, NOT, NEAR)"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Topic filtering"})," by detected sermon themes"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Timeline visualization"})," of sermons and search results"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Venue breakdown"})," showing where sermons were preached"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Direct links"})," to Living Word Broadcast for each sermon"]})]}),e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mt-6 mb-2",children:"Data Source"}),e.jsxs("p",{children:["All transcripts are sourced from ",e.jsx("a",{href:"https://www.livingwordbroadcast.org/wbtextindex/?lang=en",target:"_blank",rel:"noopener noreferrer",className:"text-amber-600 hover:text-amber-800",children:"Living Word Broadcast"}),"."]}),e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mt-6 mb-2",children:"Search Tips"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[e.jsxs("li",{children:[e.jsx("code",{className:"bg-gray-100 px-1 rounded",children:"seven seals"})," - Find exact phrase"]}),e.jsxs("li",{children:[e.jsx("code",{className:"bg-gray-100 px-1 rounded",children:"bride AND rapture"})," - Both terms required"]}),e.jsxs("li",{children:[e.jsx("code",{className:"bg-gray-100 px-1 rounded",children:"prophet OR messenger"})," - Either term"]}),e.jsxs("li",{children:[e.jsx("code",{className:"bg-gray-100 px-1 rounded",children:"healing NOT cancer"})," - Exclude a term"]}),e.jsxs("li",{children:[e.jsx("code",{className:"bg-gray-100 px-1 rounded",children:"seal* "})," - Wildcard (seals, sealed, etc.)"]})]})]})]})]}),Se&&e.jsx(Gt,{sermon:Se,searchTerm:Se.searchTerm,wholeWords:Fe.current?.wholeWords!==!1,onClose:()=>V(null),focusIndex:Nt,onFocusChange:_}),Ve&&e.jsx(Jt,{...Ve,onClose:()=>vt(null),onSermonSelect:t=>{V({...t,searchTerm:te||j}),_(0)}})]})})}export{os as default};
