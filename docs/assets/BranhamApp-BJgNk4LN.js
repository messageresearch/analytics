import{r as c,J as ws,W as st,j as e,I as u,M as _e,R as Ct,B as vs,C as St,X as $t,Y as Tt,T as Mt,a as Ns,b as ks,c as Rt,d as Cs,S as Ee,e as Ss,L as $s,A as Lt,f as Dt,V as Ts,g as Ms,h as Rs}from"./index-BguZ6VaF.js";class Ls extends c.Component{constructor(x){super(x),this.state={hasError:!1,error:null}}static getDerivedStateFromError(x){return{hasError:!0,error:x}}componentDidCatch(x,P){console.error("Uncaught error:",x,P)}render(){return this.state.hasError?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-red-50 p-4",children:e.jsxs("div",{className:"bg-white p-8 rounded-xl shadow-xl border border-red-200 max-w-lg w-full text-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-red-600 mb-4",children:"Application Error"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"A critical error stopped the dashboard."}),e.jsx("div",{className:"text-left bg-gray-100 p-2 rounded text-xs text-red-800 font-mono mb-4 overflow-auto max-h-32",children:this.state.error&&this.state.error.toString()}),e.jsx("button",{onClick:()=>window.location.reload(),className:"bg-red-600 text-white font-bold py-2 px-6 rounded hover:bg-red-700 transition",children:"Reload Page"})]})}):this.props.children}}const Ds="",Es="",Ve=N=>decodeURIComponent(N).split("/").map(P=>P.replace(/ /g,"%20").replace(/#/g,"%23")).join("/"),Et=N=>{if(!N||typeof N!="string")return null;const x=N.trim(),P=x.match(/^(.+?)\s+ONEAR\/(\d+)\s+(.+)$/i);if(P)return{type:"onear",terms:[P[1].trim(),P[3].trim()],distance:parseInt(P[2],10),ordered:!0,excluded:[]};const F=x.match(/^(.+?)\s+(?:NEAR\/(\d+)|~(\d+)|AROUND\((\d+)\))\s+(.+)$/i);if(F)return{type:"near",terms:[F[1].trim(),F[5].trim()],distance:parseInt(F[2]||F[3]||F[4],10),excluded:[]};const Y=x.match(/^(.+?)\s+(?:\/s|SENTENCE)\s+(.+)$/i);if(Y)return{type:"sentence",terms:[Y[1].trim(),Y[2].trim()],excluded:[]};const q=x.match(/^(.+?)\s+(?:\/p|PARAGRAPH)\s+(.+)$/i);if(q)return{type:"paragraph",terms:[q[1].trim(),q[2].trim()],excluded:[]};const Ae=x.match(/^"([^"]+)"$/);if(Ae)return{type:"phrase",phrase:Ae[1],excluded:[]};if(x.includes("(?=")&&x.includes(".*")){const y=[...x.matchAll(/\(\?=\.\*(?:\\b)?(\w+)(?:\\b)?\)/g)].map(Ke=>Ke[1]).filter(Boolean);if(y.length>=2)return{type:"and",required:y,excluded:[]}}let C=[],f=x;if(/\sNOT\s/i.test(f)){const j=f.split(/\s+NOT\s+/i);f=j[0].trim(),C=j.slice(1).map(y=>y.trim()).filter(Boolean)}const oe=[...f.matchAll(/(?:^|\s)[-!](\w+)/g)];if(oe.length>0&&(C=[...C,...oe.map(j=>j[1])],f=f.replace(/(?:^|\s)[-!]\w+/g," ").trim()),/\sOR\s/i.test(f)){const j=f.split(/\s+OR\s+/i).map(y=>y.trim()).filter(Boolean);if(j.length>=2||C.length>0)return{type:"or",required:j,excluded:C}}if(/\s*\|\s*/.test(f)){const j=f.split(/\s*\|\s*/).map(y=>y.trim()).filter(Boolean);if(j.length>=2||C.length>0)return{type:"or",required:j,excluded:C}}if(/\sAND\s/i.test(f)){const j=f.split(/\s+AND\s+/i).map(y=>y.trim()).filter(Boolean);if(j.length>=2||C.length>0)return{type:"and",required:j,excluded:C}}if(/^\+\S/.test(f)&&f.includes(" +")){const j=f.split(/\s+/).filter(y=>y.startsWith("+")).map(y=>y.slice(1).trim()).filter(Boolean);if(j.length>=2||C.length>0)return{type:"and",required:j,excluded:C}}if(/\s*&\s*/.test(f)&&!f.includes("|")){const j=f.split(/\s*&\s*/).map(y=>y.trim()).filter(Boolean);if(j.length>=2||C.length>0)return{type:"and",required:j,excluded:C}}return C.length>0&&f.trim()?{type:"and",required:[f.trim()],excluded:C}:null},As=/\b(Genesis|Exodus|Leviticus|Numbers|Deuteronomy|Joshua|Judges|Ruth|(?:1|2|I|II)\s*Samuel|(?:1|2|I|II)\s*Kings|(?:1|2|I|II)\s*Chronicles|Ezra|Nehemiah|Esther|Job|Psalms?|Proverbs|Ecclesiastes|Song\s*of\s*Solomon|Isaiah|Jeremiah|Lamentations|Ezekiel|Daniel|Hosea|Joel|Amos|Obadiah|Jonah|Micah|Nahum|Habakkuk|Zephaniah|Haggai|Zechariah|Malachi|Matthew|Mark|Luke|John|Acts|Romans|(?:1|2|I|II)\s*Corinthians|Galatians|Ephesians|Philippians|Colossians|(?:1|2|I|II)\s*Thessalonians|(?:1|2|I|II)\s*Timothy|Titus|Philemon|Hebrews|James|(?:1|2|I|II)\s*Peter|(?:1|2|3|I|II|III)\s*John|Jude|Revelation|Rev\.?|Gen\.?|Ex\.?|Lev\.?|Num\.?|Deut\.?|Josh\.?|Judg\.?|(?:1|2)\s*Sam\.?|(?:1|2)\s*Kgs\.?|(?:1|2)\s*Chr\.?|Neh\.?|Esth\.?|Ps\.?|Prov\.?|Eccl\.?|Isa\.?|Jer\.?|Lam\.?|Ezek\.?|Dan\.?|Hos\.?|Obad\.?|Mic\.?|Nah\.?|Hab\.?|Zeph\.?|Hag\.?|Zech\.?|Mal\.?|Matt\.?|Mk\.?|Lk\.?|Jn\.?|Rom\.?|(?:1|2)\s*Cor\.?|Gal\.?|Eph\.?|Phil\.?|Col\.?|(?:1|2)\s*Thess\.?|(?:1|2)\s*Tim\.?|Tit\.?|Phlm\.?|Heb\.?|Jas\.?|(?:1|2)\s*Pet\.?|(?:1|2|3)\s*Jn\.?|Rev\.?)\s*(\d+)(?::(\d+)(?:-(\d+))?)?\b/gi,zs=N=>{const x=N.toLowerCase().replace(/\./g,"").replace(/\s+/g," ").trim();return{gen:"Genesis",genesis:"Genesis",ex:"Exodus",exodus:"Exodus",lev:"Leviticus",leviticus:"Leviticus",num:"Numbers",numbers:"Numbers",deut:"Deuteronomy",deuteronomy:"Deuteronomy",josh:"Joshua",joshua:"Joshua",judg:"Judges",judges:"Judges",ruth:"Ruth","1 sam":"1 Samuel","2 sam":"2 Samuel","i samuel":"1 Samuel","ii samuel":"2 Samuel","1 samuel":"1 Samuel","2 samuel":"2 Samuel","1 kgs":"1 Kings","2 kgs":"2 Kings","1 kings":"1 Kings","2 kings":"2 Kings","i kings":"1 Kings","ii kings":"2 Kings","1 chr":"1 Chronicles","2 chr":"2 Chronicles","1 chronicles":"1 Chronicles","2 chronicles":"2 Chronicles",ezra:"Ezra",neh:"Nehemiah",nehemiah:"Nehemiah",esth:"Esther",esther:"Esther",job:"Job",ps:"Psalms",psalm:"Psalms",psalms:"Psalms",prov:"Proverbs",proverbs:"Proverbs",eccl:"Ecclesiastes",ecclesiastes:"Ecclesiastes","song of solomon":"Song of Solomon",isa:"Isaiah",isaiah:"Isaiah",jer:"Jeremiah",jeremiah:"Jeremiah",lam:"Lamentations",lamentations:"Lamentations",ezek:"Ezekiel",ezekiel:"Ezekiel",dan:"Daniel",daniel:"Daniel",hos:"Hosea",hosea:"Hosea",joel:"Joel",amos:"Amos",obad:"Obadiah",obadiah:"Obadiah",jonah:"Jonah",mic:"Micah",micah:"Micah",nah:"Nahum",nahum:"Nahum",hab:"Habakkuk",habakkuk:"Habakkuk",zeph:"Zephaniah",zephaniah:"Zephaniah",hag:"Haggai",haggai:"Haggai",zech:"Zechariah",zechariah:"Zechariah",mal:"Malachi",malachi:"Malachi",matt:"Matthew",matthew:"Matthew",mk:"Mark",mark:"Mark",lk:"Luke",luke:"Luke",jn:"John",john:"John",acts:"Acts",rom:"Romans",romans:"Romans","1 cor":"1 Corinthians","2 cor":"2 Corinthians","1 corinthians":"1 Corinthians","2 corinthians":"2 Corinthians",gal:"Galatians",galatians:"Galatians",eph:"Ephesians",ephesians:"Ephesians",phil:"Philippians",philippians:"Philippians",col:"Colossians",colossians:"Colossians","1 thess":"1 Thessalonians","2 thess":"2 Thessalonians","1 thessalonians":"1 Thessalonians","2 thessalonians":"2 Thessalonians","1 tim":"1 Timothy","2 tim":"2 Timothy","1 timothy":"1 Timothy","2 timothy":"2 Timothy",tit:"Titus",titus:"Titus",phlm:"Philemon",philemon:"Philemon",heb:"Hebrews",hebrews:"Hebrews",jas:"James",james:"James","1 pet":"1 Peter","2 pet":"2 Peter","1 peter":"1 Peter","2 peter":"2 Peter","1 jn":"1 John","2 jn":"2 John","3 jn":"3 John","1 john":"1 John","2 john":"2 John","3 john":"3 John","i john":"1 John","ii john":"2 John","iii john":"3 John",jude:"Jude",rev:"Revelation",revelation:"Revelation"}[x]||N.charAt(0).toUpperCase()+N.slice(1)},Ps=N=>/[*?]/.test(N),Ws=N=>{let x=N.replace(/[.+^${}()|[\]\\]/g,"\\$&");return x=x.replace(/\*/g,"\\S*").replace(/\?/g,"."),x},Os=N=>{const x=N.trim();return x.startsWith('"')&&x.endsWith('"')||x.startsWith("'")&&x.endsWith("'")?x.slice(1,-1):x},he=(N,x=!0)=>{const P=Os(N);if(Ps(P)){const q=Ws(P);return x?new RegExp(`\\b(${q})\\b`,"gi"):new RegExp(`(${q})`,"gi")}let F=P.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");F=F.replace(/'/g,"[''']?");const Y=F.replace(/\s+/g,"\\s+");return x?new RegExp(`\\b(${Y})\\b`,"gi"):new RegExp(`(${Y})`,"gi")};function Fs({onSwitchToMain:N}){const[x,P]=c.useState([]),[F,Y]=c.useState(!0),[q,Ae]=c.useState(null),[C,f]=c.useState("wmb_api/"),[oe,j]=c.useState(0),[y,Ke]=c.useState(0),[at,At]=c.useState(null),[nt,zt]=c.useState(""),[rt,Pt]=c.useState(0),[Wt,Ot]=c.useState(0),[Bt,It]=c.useState({}),[ot,Ft]=c.useState([]),[w,ze]=c.useState(Ds),[le,Pe]=c.useState(Es),[xe,We]=c.useState(null),[Ht,ye]=c.useState([]),[lt,ue]=c.useState(!1),[Jt,te]=c.useState({status:"",percent:0}),it=c.useRef({term:null,regex:null}),[Ut,$]=c.useState(""),[Bs,Oe]=c.useTransition(),[we,ct]=c.useState([]),[ve,dt]=c.useState([]),[se,mt]=c.useState([]),[Be,ht]=c.useState([]),Ne=c.useCallback(t=>Oe(()=>ct(t)),[]),ie=c.useCallback(t=>Oe(()=>dt(t)),[]),ke=c.useCallback(t=>Oe(()=>mt(t)),[]),xt=c.useCallback(t=>Oe(()=>ht(t)),[]),[Ze,_t]=c.useState(26),[Ce,Vt]=c.useState("dashboard"),[ut,Kt]=c.useState(null),[ce,B]=c.useState(null),[Zt,H]=c.useState(0),[ae,Gt]=c.useState(!0),[ge,Ge]=c.useState("bars"),[Se,Ie]=c.useState(null),[Fe,Ye]=c.useState("grid"),[Yt,qt]=c.useState(new Set),[Xt,gt]=c.useState({}),[Qt,es]=c.useState({}),[He,$e]=c.useState(new Set(["Seven Church Ages","Seven Seals"])),[S,Te]=c.useState(null),[pt,bt]=c.useState({}),[Je,ts]=c.useState(!1),[qe,ft]=c.useState(""),[ss,Me]=c.useState({key:"date",direction:"desc"}),[Ue,jt]=c.useState(()=>{try{return JSON.parse(localStorage.getItem("wmb-search-history")||"[]")}catch{return[]}});c.useEffect(()=>{localStorage.setItem("wmb-search-history",JSON.stringify(Ue.slice(0,20)))},[Ue]);const as=c.useCallback(t=>{!t||t.trim().length<2||jt(n=>[{term:t.trim(),timestamp:Date.now()},...n.filter(s=>s.term!==t.trim())].slice(0,20))},[]),[pe,ns]=c.useState(()=>{try{return JSON.parse(localStorage.getItem("wmb-reading-progress")||"{}")}catch{return{}}});c.useEffect(()=>{localStorage.setItem("wmb-reading-progress",JSON.stringify(pe))},[pe]);const rs=c.useCallback((t,n)=>{ns(s=>({...s,[t]:{position:n,timestamp:Date.now()}}))},[]);c.useCallback(t=>pe[t],[pe]);const[Re,yt]=c.useState(!1),[Z,os]=c.useState(null),be=c.useCallback(async(t,n,s=null)=>{if(!t||t.length===0){alert("No transcripts available to download");return}const r=t.filter(o=>o.path);if(r.length===0){alert("No downloadable transcripts found");return}Te({current:0,total:r.length,year:s});try{const o=new ws,l="/wmbmentions.github.io/";let a=0;for(let h=0;h<r.length;h++){const g=r[h];Te({current:h+1,total:r.length,year:s});try{const k=`${l}${Ve(g.path)}`,b=await fetch(k);if(b.ok){const v=await b.text(),p=g.path.split("/").pop();o.file(p,v),a++}}catch(k){console.warn(`Failed to fetch ${g.path}:`,k)}}if(a===0){alert("Could not download any transcripts. Please try downloading from Living Word Broadcast."),Te(null);return}const d=await o.generateAsync({type:"blob"}),i=URL.createObjectURL(d),m=document.createElement("a");m.href=i,m.download=n,document.body.appendChild(m),m.click(),document.body.removeChild(m),URL.revokeObjectURL(i),Te(null)}catch(o){console.error("Error creating zip:",o),alert("Error creating download. Please try again or download from Living Word Broadcast."),Te(null)}},[]),Xe=c.useMemo(()=>({"Seven Church Ages":{dateCodes:["60-1205","60-1206","60-1207","60-1208","60-1209","60-1210","60-1211E"],color:"indigo",description:"December 5-11, 1960 - Branham Tabernacle"},"Seven Seals":{dateCodes:["63-0317E","63-0318","63-0319","63-0320","63-0321","63-0322","63-0323","63-0324E"],color:"amber",description:"March 17-24, 1963 - Branham Tabernacle"}}),[]),ls=c.useCallback(t=>{const n=Xe[t];return n?x.filter(s=>n.dateCodes.some(r=>s.dateCode===r||s.id?.startsWith(r))).sort((s,r)=>(s.date||"").localeCompare(r.date||"")):[]},[x,Xe]),is=c.useCallback((t,n=5)=>{if(!t||!x.length)return[];const s=[],r=new Date(t.timestamp);return x.forEach(o=>{if(o.id===t.id)return;let l=0;if(t.topics&&o.topics){const i=t.topics.filter(m=>o.topics.includes(m)).length;l+=i*10}t.venue&&o.venue===t.venue&&(l+=5);const a=new Date(o.timestamp),d=Math.abs((r-a)/(1e3*60*60*24));d<=7?l+=8:d<=30?l+=4:d<=90&&(l+=2),l>0&&s.push({...o,relatedScore:l})}),s.sort((o,l)=>l.relatedScore-o.relatedScore).slice(0,n)},[x]),cs=c.useCallback(async()=>{if(Re)return;yt(!0);const t=new Map,n=50;try{for(let r=0;r<oe;r+=n){const o=[];for(let a=r;a<Math.min(r+n,oe);a++)o.push(fetch(`${C}text_chunk_${a}.json`).then(d=>d.ok?d.json():[]).catch(()=>[]));const l=await Promise.all(o);for(const a of l)for(const d of a){let i;const m=new RegExp(As.source,"gi");for(;(i=m.exec(d.text))!==null;){const h=zs(i[1]),g=i[2],k=i[3]||"",b=k?`${h} ${g}:${k}`:`${h} ${g}`;t.has(h)||t.set(h,{count:0,refs:new Map});const v=t.get(h);v.count++,v.refs.has(b)||v.refs.set(b,{count:0,sermons:new Set}),v.refs.get(b).count++,v.refs.get(b).sermons.add(d.id)}}await new Promise(a=>setTimeout(a,10))}const s=Array.from(t.entries()).map(([r,o])=>({book:r,count:o.count,refs:Array.from(o.refs.entries()).map(([l,a])=>({ref:l,count:a.count,sermons:Array.from(a.sermons)})).sort((l,a)=>a.count-l.count).slice(0,10)})).sort((r,o)=>o.count-r.count);os(s)}catch(s){console.error("Scripture scan failed:",s)}yt(!1)},[oe,C,Re]),[J,Le]=c.useState({date:"",venue:"",title:"",topic:""}),[de,Qe]=c.useState({key:"timestamp",direction:"desc"}),[fe,et]=c.useState(null),[wt,ds]=c.useState({x:0,y:0}),ms=c.useRef(null);c.useEffect(()=>{Qe(xe!==null?{key:"mentionCount",direction:"desc"}:{key:"timestamp",direction:"desc"})},[xe]),c.useEffect(()=>{const t=n=>{n.key==="Escape"&&ce&&B(null)};return window.addEventListener("keydown",t),()=>window.removeEventListener("keydown",t)},[ce]),c.useEffect(()=>{let t=!0;return(async()=>{try{const s=["wmb_api/metadata.json","/wmbmentions.github.io/wmb_api/metadata.json","https://raw.githubusercontent.com/messageanalytics/wmbmentions.github.io/main/docs/wmb_api/metadata.json"];let r=null,o="wmb_api/";for(const h of s)try{if(r=await fetch(h),r.ok){o=h.includes("raw.githubusercontent")?"https://raw.githubusercontent.com/messageanalytics/wmbmentions.github.io/main/docs/wmb_api/":h.includes("/wmbmentions.github.io/")?"/wmbmentions.github.io/wmb_api/":"wmb_api/";break}}catch{}if(!r||!r.ok)throw new Error("WMB Metadata not found.");const l=await r.json();if(!t)return;const a=l.generated||"Unknown";At(a),j(l.totalChunks||0),Ke(l.totalSermons||0),zt(l.yearRange||""),Pt(l.totalWords||0),Ot(l.totalDurationMinutes||0),It(l.topicCounts||{}),Ft(l.venues||[]),f(o);const d=(l.sermons||[]).map(h=>{const g=h.duration&&h.duration>0?h.duration:null,k=h.wordCount/st/60,b=g?g/60:k>0?k:.5;return{...h,durationHrs:b,durationMinutes:g,mentionCount:0,mentionsPerHour:0}});P(d),ct([...new Set(d.map(h=>h.title))].filter(Boolean));const i=[...new Set(d.map(h=>h.year))].filter(h=>h!=="Unknown").sort();dt(i),mt([...new Set(d.map(h=>h.venue))].filter(Boolean));const m=[...new Set(d.flatMap(h=>h.topics||[]))];ht(m),Y(!1)}catch(s){console.error("Failed to load WMB data:",s),t&&(Ae(s.message),Y(!1))}})(),()=>{t=!1}},[]);const R=c.useMemo(()=>({titles:[...new Set(x.map(t=>t.title))].filter(Boolean).sort(),years:[...new Set(x.map(t=>t.year))].filter(t=>t!=="Unknown").sort(),venues:[...new Set(x.map(t=>t.venue))].filter(Boolean).sort(),topics:[...new Set(x.flatMap(t=>t.topics||[]))].sort()}),[x]),vt=c.useMemo(()=>xe===null?x:x.map(t=>{const n=xe.get(t.id)||0;return{...t,mentionCount:n,mentionsPerHour:t.durationHrs>0?parseFloat((n/t.durationHrs).toFixed(1)):0,searchTerm:le}}),[x,xe,le]),Nt=c.useMemo(()=>({titles:new Set(we),years:new Set(ve),venues:new Set(se),topics:new Set(Be)}),[we,ve,se,Be]),L=c.useMemo(()=>{const{titles:t,years:n,venues:s,topics:r}=Nt;return vt.filter(o=>{const l=!r.size||o.topics&&o.topics.some(a=>r.has(a));return t.has(o.title)&&n.has(o.year)&&s.has(o.venue)&&l})},[vt,Nt]),G=c.useMemo(()=>{if(!L.length)return null;const t=L.length,n=L.reduce((o,l)=>o+(l.mentionCount||0),0);let s=0,r=null;return L.forEach(o=>{(o.mentionCount||0)>s&&(s=o.mentionCount,r=o)}),{totalSermons:t,totalMentions:n,maxMentions:s,peakSermon:r,avg:t>0?(n/t).toFixed(1):"0",totalWords:L.reduce((o,l)=>o+(l.wordCount||0),0),totalDuration:L.reduce((o,l)=>o+(l.duration||0),0)}},[L]),tt=c.useMemo(()=>L.length?[...L].sort((n,s)=>n.timestamp-s.timestamp).map(n=>({timestamp:n.timestamp,mentionCount:n.mentionCount||0,title:n.title,...n})):[],[L]),me=c.useMemo(()=>{if(!tt.length)return[];const t=new Map;tt.forEach(r=>{const o=new Date(r.timestamp);o.setHours(0,0,0,0),o.setDate(o.getDate()-o.getDay());const l=o.getTime();t.has(l)||t.set(l,{timestamp:l,mentionCount:0,count:0,sermons:[]});const a=t.get(l);a.mentionCount+=r.mentionCount||0,a.count++,a.sermons.push(r)});const n=Array.from(t.values()).sort((r,o)=>r.timestamp-o.timestamp),s=Ze;return n.forEach((r,o)=>{const l=Math.max(0,o-s+1),a=n.slice(l,o+1),d=a.reduce((m,h)=>m+h.mentionCount,0)/a.length,i=a.reduce((m,h)=>m+h.count,0)/a.length;r.rollingAvg=parseFloat(d.toFixed(1)),r.volumeRollingAvg=parseFloat(i.toFixed(1))}),n},[tt,Ze]),hs=c.useMemo(()=>me.length?[me[0].timestamp,me[me.length-1].timestamp]:["auto","auto"],[me]),xs=t=>new Date(t).toLocaleDateString(void 0,{month:"short",year:"2-digit"}),X=c.useMemo(()=>{if(!L.length)return[];const t=new Map;L.forEach(s=>{const r=s.venue||"Unknown";t.has(r)||t.set(r,{count:0,totalWords:0,years:new Set});const o=t.get(r);o.count++,o.totalWords+=s.wordCount||0,s.date&&o.years.add(s.date.slice(0,4))});const n=L.length;return Array.from(t.entries()).map(([s,r])=>{const o=Array.from(r.years).sort();return{venue:s,count:r.count,percent:(r.count/n*100).toFixed(1),totalWords:r.totalWords,dateRange:o.length>0?`${o[0]} - ${o[o.length-1]}`:"N/A"}}).sort((s,r)=>r.count-s.count)},[L]),Q=c.useMemo(()=>{if(!x.length)return{venues:[],years:[],data:new Map,maxCount:0};const t=new Map,n=new Set,s=new Map;for(const a of x){const d=a.venue||"Unknown",i=a.year||"Unknown";n.add(i);const m=`${d}|${i}`;t.set(m,(t.get(m)||0)+1),s.set(d,(s.get(d)||0)+1)}const r=Array.from(s.entries()).sort((a,d)=>d[1]-a[1]).map(([a])=>a),o=Array.from(n).filter(a=>a!=="Unknown").sort();let l=0;for(const a of t.values())a>l&&(l=a);return{venues:r,years:o,data:t,maxCount:l,venueTotals:s}},[x]),ee=c.useMemo(()=>{if(!x.length)return{locations:[],years:[],data:new Map,maxCount:0};const t=new Map,n=new Set,s=new Map;for(const a of x){const d=a.location||"Unknown",i=a.year||"Unknown";n.add(i);const m=`${d}|${i}`;t.set(m,(t.get(m)||0)+1),s.set(d,(s.get(d)||0)+1)}const r=Array.from(s.entries()).sort((a,d)=>d[1]-a[1]).map(([a])=>a),o=Array.from(n).filter(a=>a!=="Unknown").sort();let l=0;for(const a of t.values())a>l&&(l=a);return{locations:r,years:o,data:t,maxCount:l,locationTotals:s}},[x]),us=c.useMemo(()=>{const t=new Map;return x.forEach(n=>{const s=n.year||"Unknown";t.has(s)||t.set(s,[]),t.get(s).push(n)}),Array.from(t.entries()).map(([n,s])=>({year:n,sermons:s.sort((r,o)=>(r.date||"").localeCompare(o.date||"")),count:s.length,totalWords:s.reduce((r,o)=>r+(o.wordCount||0),0)})).sort((n,s)=>s.year.localeCompare(n.year))},[x]),T=async(t,n,s=null,r={})=>{if(!t&&!s){We(null),ze(""),Pe(""),ye([]);return}as(t||s),it.current={term:t,rawRegex:s,variations:n,...r},ue(!0),te({status:"Preparing search...",percent:0}),ye([]),await gs(t,n,s,r)},gs=async(t,n,s=null,r={})=>{const{wholeWords:o=!0}=r;try{const a=Object.create(null),d=t&&Et(t)?t:s||t||"",i=Et(d);let m;if(i){const{type:p,required:D,excluded:V,terms:ne,distance:E,ordered:I,phrase:K}=i;if(p==="or"){const A=D.map(W=>he(W,o));m=W=>{for(const O of V)if(he(O,o).test(W))return 0;let z=0;const _=[];for(let O=0;O<A.length;O++){A[O].lastIndex=0;const M=W.match(A[O]);if(M&&M.length>0){z+=M.length;for(const je of M)_.push(je.toLowerCase())}}return{count:z,matched:_}}}else if(p==="and"){const A=D.map(W=>he(W,o));m=W=>{for(const O of V)if(he(O,o).test(W))return 0;let z=0;const _=[];for(let O=0;O<A.length;O++){A[O].lastIndex=0;const M=W.match(A[O]);if(!M||M.length===0)return 0;z+=M.length;for(const je of M)_.push(je.toLowerCase())}return{count:z,matched:_}}}else if(p==="phrase"){const A=o?new RegExp(`\\b(${K.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")})\\b`,"gi"):new RegExp(`(${K.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")})`,"gi");m=W=>{const z=W.match(A);return z?{count:z.length,matched:z.map(_=>_.toLowerCase())}:0}}else if(p==="near"||p==="onear"){const[A,W]=ne,z=he(A,o),_=he(W,o);m=O=>{const M=O.split(/\s+/);let je=0;const kt=[];for(let re=0;re<M.length;re++)if(z.lastIndex=0,z.test(M[re])){const js=I?re+1:Math.max(0,re-E),ys=Math.min(M.length,re+E+1);for(let De=js;De<ys;De++)De!==re&&(_.lastIndex=0,_.test(M[De])&&(je++,kt.push(M[re].toLowerCase(),M[De].toLowerCase())))}return{count:je,matched:[...new Set(kt)]}}}else{const A=he(d,o);m=W=>{const z=W.match(A);return z?{count:z.length,matched:z.map(_=>_.toLowerCase())}:0}}}else if(s&&s.trim()){let p;try{p=o?new RegExp(`\\b(${s})\\b`,"gi"):new RegExp(`(${s})`,"gi")}catch(D){te({status:`Invalid regex: ${D.message}`,percent:0,error:!0}),ue(!1);return}m=D=>{p.lastIndex=0;const V=D.match(p);return V?{count:V.length,matched:V.map(ne=>ne.toLowerCase())}:0}}else{const p=E=>(""+E).replace(/[.*+?^${}()|[\]\\]/g,"\\$&");let D=[t].filter(Boolean);if(n){const E=Array.isArray(n)?n:n.split(",").map(I=>I.trim()).filter(Boolean);D=[...D,...E.filter(Boolean)]}if(D.length===0){ue(!1);return}const V=D.map(p).join("|"),ne=o?new RegExp(`\\b(${V})\\b`,"gi"):new RegExp(`(${V})`,"gi");m=E=>{ne.lastIndex=0;const I=E.match(ne);return I?{count:I.length,matched:I.map(K=>K.toLowerCase())}:0}}const h=Object.create(null),g=oe||0;if(!g||g===0){te({status:"No data available",percent:0,error:!0}),ue(!1);return}te({status:"Searching transcripts...",percent:10});let k=0;for(let p=0;p<g;p+=50){const D=[];for(let E=p;E<Math.min(p+50,g);E++)D.push(fetch(`${C}text_chunk_${E}.json`).then(I=>I.ok?I.json():[]).catch(()=>[]));const V=await Promise.all(D);for(const E of V){for(const I of E)try{const K=m(I.text);if(K&&K.count>0&&(h[I.id]=(h[I.id]||0)+K.count,K.matched))for(const A of K.matched)a[A]=(a[A]||0)+1}catch{}k++}const ne=Math.round(k/g*100);te({status:"Searching transcripts...",percent:10+Math.round(ne*.85),detail:`${k} of ${g} chunks`}),await new Promise(E=>setTimeout(E,5))}te({status:"Counting matches...",percent:95});const b=new Map;for(const p in h)Object.hasOwn(h,p)&&b.set(p,h[p]);We(b),ze(t),Pe(s&&s.trim()?s:d);const v=[];for(const p in a)Object.hasOwn(a,p)&&v.push({term:p,count:a[p]});v.sort((p,D)=>D.count-p.count),ye(v.slice(0,50)),ue(!1),te({status:"Done!",percent:100})}catch(l){console.error("Search failed",l),ue(!1),te({status:"Search failed",percent:0,error:!0})}},U=c.useMemo(()=>{let t=[...L];if(J.date&&(t=t.filter(n=>n.date.includes(J.date))),J.venue&&(t=t.filter(n=>n.venue&&n.venue.toLowerCase().includes(J.venue.toLowerCase()))),J.title&&(t=t.filter(n=>n.title.toLowerCase().includes(J.title.toLowerCase()))),J.search){const n=J.search.toLowerCase();t=t.filter(s=>(s.title||"").toLowerCase().includes(n)||(s.venue||"").toLowerCase().includes(n)||(s.location||"").toLowerCase().includes(n)||(s.date||"").toLowerCase().includes(n))}return de.key&&t.sort((n,s)=>{let r=n[de.key],o=s[de.key];return typeof r=="string"&&(r=r.toLowerCase()),typeof o=="string"&&(o=o.toLowerCase()),r<o?de.direction==="asc"?-1:1:r>o?de.direction==="asc"?1:-1:0}),t},[L,J,de]),ps=c.useCallback(()=>{if(!U||U.length===0){alert("No results to export");return}const t=["Date","Title","Venue","Words","Matches","Duration (min)"],n=U.map(a=>[a.date||"",`"${(a.title||"").replace(/"/g,'""')}"`,`"${(a.venue||"").replace(/"/g,'""')}"`,a.wordCount||0,a.mentionCount||0,Math.round((a.wordCount||0)/st)]),s=[t.join(","),...n.map(a=>a.join(","))].join(`
`),r=new Blob([s],{type:"text/csv"}),o=URL.createObjectURL(r),l=document.createElement("a");l.href=o,l.download=`wmb_search_results_${(w||"all").replace(/[^a-zA-Z0-9]/g,"_")}_${new Date().toISOString().split("T")[0]}.csv`,l.click(),URL.revokeObjectURL(o)},[U,w]),bs=()=>{Ne(R.titles),ie(R.years),ke(R.venues),xt(R.topics)},fs=we.length!==R.titles.length||ve.length!==R.years.length||se.length!==R.venues.length||Be.length!==R.topics.length;return F?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-amber-50 to-orange-100",children:e.jsxs("div",{className:"text-center p-8 bg-white rounded-2xl shadow-xl border border-amber-200 max-w-md w-full mx-4",children:[e.jsx("div",{className:"w-16 h-16 border-4 border-amber-200 border-t-amber-600 rounded-full animate-spin mx-auto mb-6"}),e.jsx("h2",{className:"text-2xl font-bold text-amber-800 mb-2",children:"Loading Branham Archive"}),e.jsx("p",{className:"text-amber-600 text-sm",children:"1,181 sermons â€¢ 17.5M words â€¢ 1947-1965"})]})}):q?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-red-50 p-4",children:e.jsxs("div",{className:"bg-white p-8 rounded-xl shadow-xl border border-red-200 max-w-lg w-full text-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-red-600 mb-4",children:"Failed to Load"}),e.jsx("p",{className:"text-gray-600 mb-4",children:q}),e.jsx("button",{onClick:()=>window.location.reload(),className:"bg-red-600 text-white font-bold py-2 px-6 rounded hover:bg-red-700 transition",children:"Retry"})]})}):e.jsx(Ls,{children:e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-amber-50 via-orange-50 to-yellow-50",children:[e.jsx("div",{className:"bg-gradient-to-r from-amber-700 to-orange-600 text-white shadow-lg sticky top-0 z-40",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-3 flex flex-col md:flex-row justify-between items-start md:items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[e.jsx("div",{className:"bg-white/20 backdrop-blur p-2 rounded-lg shadow-lg flex-shrink-0",children:e.jsx(u,{name:"book",className:"text-white"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("h1",{className:"font-bold text-base md:text-lg text-white leading-tight truncate",children:"William Branham Sermon Archive"}),e.jsxs("p",{className:"text-xs text-amber-100 truncate",children:[nt," â€¢ ",y.toLocaleString()," sermons â€¢ ",(rt/1e6).toFixed(1),"M words"]})]})]}),e.jsxs("div",{className:"flex flex-col md:flex-row items-stretch md:items-center gap-3 md:gap-4 w-full md:w-auto",children:[at&&e.jsxs("div",{className:"text-xs text-amber-200 text-center md:text-right",children:["Data: ",at]}),e.jsx("div",{className:"flex bg-white/10 backdrop-blur p-1 rounded-lg w-full md:w-auto",children:[{key:"dashboard",label:"Search & Stats"},{key:"data",label:"Sources"},{key:"about",label:"About"}].map(t=>e.jsx("button",{onClick:()=>Vt(t.key),className:`px-3 md:px-4 py-1.5 rounded-md text-xs md:text-sm font-medium transition flex-1 md:flex-none ${Ce===t.key?"bg-white text-amber-700 shadow-sm":"text-amber-100 hover:text-white hover:bg-white/10"}`,children:t.label},t.key))}),N&&e.jsx("button",{onClick:N,className:"px-3 py-1.5 bg-white/10 hover:bg-white/20 rounded-md text-xs font-medium text-amber-100 hover:text-white transition",children:"â† Back to Main"})]})]})}),e.jsxs("div",{className:"bg-amber-100 border-b border-amber-200 text-amber-800 text-xs text-center py-2 px-4",children:[e.jsx("span",{className:"font-bold",children:"Source:"})," Transcripts from ",e.jsx("a",{href:"https://www.livingwordbroadcast.org/wbtextindex",target:"_blank",rel:"noopener noreferrer",className:"text-amber-700 hover:text-amber-900 underline",children:"Living Word Broadcast"})," â€¢ Click any sermon to read the full transcript â€¢ ",e.jsx("kbd",{className:"px-1 py-0.5 bg-amber-200 rounded text-xs",children:"âŒ˜K"})," to search"]}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-6",children:[Ce==="dashboard"&&e.jsxs("div",{className:"bg-white p-4 rounded-xl border shadow-sm mb-6",children:[e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-2 mb-3",children:[e.jsxs("h3",{className:"font-bold text-gray-800 flex items-center gap-2 text-sm",children:[e.jsx(u,{name:"filter",size:16})," Filters"]}),e.jsx("div",{className:"flex items-center gap-2",children:fs&&e.jsx("button",{onClick:bs,className:"text-xs text-amber-600 hover:text-amber-800 font-medium",children:"Clear all filters"})})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:[e.jsx(_e,{label:"Years",options:R.years,selected:ve,onChange:ie}),e.jsx(_e,{label:"Venues",options:R.venues,selected:se,onChange:ke}),e.jsx(_e,{label:"Topics",options:R.topics,selected:Be,onChange:xt}),e.jsx(_e,{label:"Titles",options:R.titles,selected:we,onChange:Ne})]}),Object.keys(pe).length>0&&e.jsxs("div",{className:"mt-4 pt-4 border-t",children:[e.jsxs("h4",{className:"text-sm font-bold text-gray-700 flex items-center gap-1 mb-2",children:[e.jsx(u,{name:"clock",size:14,className:"text-blue-500"})," Continue Reading"]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:Object.entries(pe).sort((t,n)=>n[1].timestamp-t[1].timestamp).slice(0,5).map(([t,n])=>{const s=x.find(r=>r.id===t);return s?e.jsxs("button",{onClick:()=>{B({...s,resumePosition:n.position}),H(0)},className:"px-2 py-1 bg-blue-50 hover:bg-blue-100 border border-blue-200 rounded text-xs text-blue-800 flex items-center gap-1 max-w-xs",children:[e.jsx(u,{name:"arrowRight",size:12}),e.jsx("span",{className:"truncate",children:s.title}),e.jsxs("span",{className:"text-blue-500",children:["(",Math.round(n.position*100),"%)"]})]},t):null})})]})]}),Ce==="dashboard"&&G&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-white rounded-xl border shadow-sm mb-6",children:[e.jsxs("button",{onClick:()=>Gt(!ae),className:`w-full flex items-center justify-between p-4 transition-colors ${ae?"bg-gradient-to-r from-amber-50 to-orange-50 hover:from-amber-100 hover:to-orange-100":"hover:bg-gray-50"}`,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(u,{name:ae?"chevronRight":"chevronDown",size:18,className:ae?"text-amber-600":"text-gray-500"}),e.jsxs("h3",{className:`font-bold ${ae?"text-amber-800":"text-gray-800"}`,children:[e.jsx(u,{name:"barChart",className:"inline mr-1",size:16})," Sermons by Venue"]}),e.jsxs("span",{className:"text-sm text-gray-500",children:["(",X.length," venues)"]})]}),e.jsx("span",{className:`text-sm font-medium ${ae?"text-amber-600 bg-amber-100 px-3 py-1 rounded-full":"text-xs text-gray-400"}`,children:ae?"â–¶ Click to view":"Click to collapse"})]}),!ae&&e.jsxs("div",{className:"p-4 pt-2",children:[e.jsxs("div",{className:"flex gap-2 mb-3",children:[e.jsx("button",{onClick:()=>Ge("bars"),className:`px-3 py-1.5 text-sm font-medium rounded-lg transition-colors ${ge==="bars"?"bg-amber-600 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:"ðŸ“Š Bar Chart"}),e.jsx("button",{onClick:()=>Ge("heatmap"),className:`px-3 py-1.5 text-sm font-medium rounded-lg transition-colors ${ge==="heatmap"?"bg-amber-600 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:"ðŸ—“ï¸ Venue Ã— Year"}),e.jsx("button",{onClick:()=>Ge("location"),className:`px-3 py-1.5 text-sm font-medium rounded-lg transition-colors ${ge==="location"?"bg-amber-600 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:"ðŸ“ Location Ã— Year"})]}),ge==="bars"&&X.length>0&&(()=>{const t=Math.max(...X.map(r=>r.count)),n=Math.ceil(t/50)*50,s=[];for(let r=0;r<=n;r+=50)s.push(r);return e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-xs text-gray-500 mb-3",children:"Click a bar to filter sermons by that venue. Darker bars = more sermons."}),e.jsx("div",{style:{height:Math.max(400,X.length*20)},children:e.jsx(Ct,{width:"100%",height:"100%",children:e.jsxs(vs,{data:X,layout:"vertical",margin:{top:10,right:30,left:5,bottom:5},barSize:14,children:[e.jsx(St,{strokeDasharray:"3 3",horizontal:!1}),e.jsx($t,{type:"number",tickFormatter:r=>r.toLocaleString(),orientation:"top",axisLine:!1,tickLine:!1,tick:{fontSize:10},ticks:s,domain:[0,n]}),e.jsx(Tt,{type:"category",dataKey:"venue",width:typeof window<"u"&&window.innerWidth<640?120:200,tick:{fontSize:typeof window<"u"&&window.innerWidth<640?8:10},interval:0}),e.jsx(Mt,{content:({active:r,payload:o})=>{if(!r||!o||!o.length)return null;const l=o[0].payload;return e.jsxs("div",{className:"bg-white border rounded-lg shadow-lg p-3 text-sm max-w-xs",children:[e.jsx("p",{className:"font-bold text-gray-800 mb-2",children:l.venue}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("p",{className:"text-amber-600",children:["ðŸ“Š Sermons: ",e.jsx("span",{className:"font-semibold",children:l.count.toLocaleString()})," ",e.jsxs("span",{className:"text-gray-400",children:["(",l.percent,"%)"]})]}),e.jsxs("p",{className:"text-gray-600",children:["ðŸ“… Years: ",l.dateRange]}),e.jsxs("p",{className:"text-blue-600",children:["ðŸ“ Words: ",e.jsx("span",{className:"font-semibold",children:l.totalWords.toLocaleString()})]})]}),e.jsx("p",{className:"text-xs text-gray-400 mt-2 italic",children:"Click to browse sermons"})]})}}),e.jsx(Ns,{dataKey:"count",radius:[0,4,4,0],children:X.map((r,o)=>{const l=1-o/(X.length-1||1),a=Math.round(254+-74*l),d=Math.round(243+-160*l),i=Math.round(199+-190*l),m=`rgb(${a},${d},${i})`,h=Se===r.venue;return e.jsx(ks,{fill:h?"#d97706":m,stroke:h?"#92400e":"none",strokeWidth:h?2:0,style:{cursor:"pointer"},onClick:()=>Ie(r.venue)},r.venue)})})]})})})]})})(),ge==="heatmap"&&Q&&e.jsxs("div",{className:"overflow-x-auto",children:[e.jsx("p",{className:"text-xs text-gray-500 mb-3",children:"Sermon distribution by venue and year. Darker = more sermons. Click to filter."}),e.jsxs("div",{className:"grid border border-gray-300 rounded overflow-hidden",style:{gridTemplateColumns:`200px repeat(${Q.years.length}, minmax(32px, 1fr))`,minWidth:`${200+Q.years.length*36}px`},children:[e.jsx("div",{className:"bg-gray-100 p-1.5 text-xs font-bold text-gray-700 sticky left-0 z-10 border-b border-r border-gray-300",children:"Venue"}),Q.years.map(t=>e.jsx("div",{className:"bg-gray-100 p-1.5 text-xs font-bold text-gray-700 text-center border-b border-r border-gray-300",children:t.toString().slice(-2)},t)),Q.venues.map((t,n)=>e.jsxs(Rt.Fragment,{children:[e.jsx("div",{className:`bg-white p-1.5 text-xs truncate sticky left-0 z-10 cursor-pointer hover:bg-amber-50 border-b border-r border-gray-200 ${se.includes(t)?"bg-amber-100 font-semibold":""}`,title:`${t} (${Q.venueTotals.get(t)||0} sermons)`,onClick:()=>{se.includes(t)?ke(se.filter(s=>s!==t)):ke([...se,t])},children:t}),Q.years.map(s=>{const r=Q.data.get(`${t}|${s}`)||0,o=r>0?Math.min(.15+r/Q.maxCount*.85,1):0;return e.jsx("div",{className:"p-1.5 text-center text-xs cursor-pointer transition-colors hover:ring-1 hover:ring-amber-400 border-b border-r border-gray-200",style:{backgroundColor:r>0?`rgba(217, 119, 6, ${o})`:"white",color:o>.5?"white":r>0?"#92400e":"#9ca3af"},title:`${t} (${s}): ${r} sermon${r!==1?"s":""}`,onClick:()=>{ke([t]),ie([s.toString()])},children:r>0?r:"Â·"},`${t}-${s}`)})]},t))]}),e.jsxs("div",{className:"flex items-center justify-end gap-2 mt-3 text-xs text-gray-500",children:[e.jsx("span",{children:"Fewer"}),e.jsx("div",{className:"flex",children:[.15,.35,.55,.75,.95].map((t,n)=>e.jsx("div",{className:"w-5 h-4",style:{backgroundColor:`rgba(217, 119, 6, ${t})`}},n))}),e.jsx("span",{children:"More sermons"})]})]}),ge==="location"&&ee&&e.jsxs("div",{className:"overflow-x-auto",children:[e.jsx("p",{className:"text-xs text-gray-500 mb-3",children:"Sermon distribution by location (city) and year. Darker = more sermons. Click to filter."}),e.jsxs("div",{className:"grid border border-gray-300 rounded overflow-hidden",style:{gridTemplateColumns:`200px repeat(${ee.years.length}, minmax(32px, 1fr))`,minWidth:`${200+ee.years.length*36}px`},children:[e.jsx("div",{className:"bg-gray-100 p-1.5 text-xs font-bold text-gray-700 sticky left-0 z-10 border-b border-r border-gray-300",children:"Location"}),ee.years.map(t=>e.jsx("div",{className:"bg-gray-100 p-1.5 text-xs font-bold text-gray-700 text-center border-b border-r border-gray-300",children:t.toString().slice(-2)},t)),ee.locations.map((t,n)=>e.jsxs(Rt.Fragment,{children:[e.jsx("div",{className:"bg-white p-1.5 text-xs truncate sticky left-0 z-10 cursor-pointer hover:bg-amber-50 border-b border-r border-gray-200",title:`${t} (${ee.locationTotals.get(t)||0} sermons)`,onClick:()=>{Le(s=>({...s,search:t}))},children:t}),ee.years.map(s=>{const r=ee.data.get(`${t}|${s}`)||0,o=r>0?Math.min(.15+r/ee.maxCount*.85,1):0;return e.jsx("div",{className:"p-1.5 text-center text-xs cursor-pointer transition-colors hover:ring-1 hover:ring-amber-400 border-b border-r border-gray-200",style:{backgroundColor:r>0?`rgba(16, 185, 129, ${o})`:"white",color:o>.5?"white":r>0?"#065f46":"#9ca3af"},title:`${t} (${s}): ${r} sermon${r!==1?"s":""}`,onClick:()=>{Le(l=>({...l,search:t})),ie([s.toString()])},children:r>0?r:"Â·"},`${t}-${s}`)})]},t))]}),e.jsxs("div",{className:"flex items-center justify-end gap-2 mt-3 text-xs text-gray-500",children:[e.jsx("span",{children:"Fewer"}),e.jsx("div",{className:"flex",children:[.15,.35,.55,.75,.95].map((t,n)=>e.jsx("div",{className:"w-5 h-4",style:{backgroundColor:`rgba(16, 185, 129, ${t})`}},n))}),e.jsx("span",{children:"More sermons"})]})]})]})]}),Ue.length>0&&e.jsxs("div",{className:"flex flex-wrap items-center gap-2 mb-3",children:[e.jsx("span",{className:"text-xs text-gray-500",children:"Recent:"}),Ue.slice(0,8).map((t,n)=>e.jsx("button",{onClick:()=>{$(t.term),T(t.term,"",null,{wholeWords:!0})},className:"px-2 py-0.5 bg-gray-100 hover:bg-gray-200 text-gray-600 rounded text-xs transition",children:t.term.length>20?t.term.slice(0,20)+"...":t.term},n)),e.jsx("button",{onClick:()=>{confirm("Clear search history?")&&jt([])},className:"text-xs text-gray-400 hover:text-red-500",children:"âœ•"})]}),e.jsx(Cs,{onAnalyze:T,isAnalyzing:lt,progress:Jt,initialTerm:"",initialVariations:"",matchedTerms:Ht,totalTranscripts:y,defaultTerm:"",defaultRegex:"",externalTerm:Ut}),e.jsxs("div",{className:"flex flex-wrap gap-2 mb-6",children:[e.jsx("span",{className:"text-sm text-gray-500 font-medium self-center mr-2",children:"Featured Series:"}),e.jsxs("button",{onClick:()=>{const t=["63-0317E","63-0318","63-0319","63-0320","63-0321","63-0322","63-0323","63-0324E"],n=x.filter(s=>t.some(r=>s.dateCode===r||s.id?.startsWith(r))).map(s=>s.title);n.length>0&&(Ne(n),ie(["1963"]))},className:"px-3 py-1.5 bg-amber-100 hover:bg-amber-200 text-amber-800 rounded-lg text-sm font-medium transition flex items-center gap-1.5",children:[e.jsx(u,{name:"book",size:14})," The Seven Seals"]}),e.jsxs("button",{onClick:()=>{const t=["60-1205","60-1206","60-1207","60-1208","60-1209","60-1210","60-1211E"],n=x.filter(s=>t.some(r=>s.dateCode===r||s.id?.startsWith(r))).map(s=>s.title);n.length>0&&(Ne(n),ie(["1960"]))},className:"px-3 py-1.5 bg-indigo-100 hover:bg-indigo-200 text-indigo-800 rounded-lg text-sm font-medium transition flex items-center gap-1.5",children:[e.jsx(u,{name:"book",size:14})," The Seven Church Ages"]}),(we.length!==R.titles.length||ve.length!==R.years.length)&&e.jsxs("button",{onClick:()=>{Ne(R.titles),ie(R.years)},className:"px-3 py-1.5 bg-gray-100 hover:bg-gray-200 text-gray-600 rounded-lg text-sm font-medium transition flex items-center gap-1.5",children:[e.jsx(u,{name:"x",size:14})," Show All Sermons"]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 mb-6",children:[e.jsx("span",{className:"text-sm text-gray-500 font-medium self-center mr-2",children:"Hot Topics:"}),e.jsxs("button",{onClick:()=>{$('"THUS SAITH THE LORD"'),T('"THUS SAITH THE LORD"',"",null,{wholeWords:!0})},className:"px-3 py-1.5 bg-red-100 hover:bg-red-200 text-red-800 rounded-lg text-sm font-medium transition flex items-center gap-1.5",children:[e.jsx(u,{name:"search",size:14}),' "THUS SAITH THE LORD"']}),e.jsx("button",{onClick:()=>{$("faith"),T("faith","",null,{wholeWords:!0})},className:"px-2.5 py-1 bg-purple-100 hover:bg-purple-200 text-purple-800 rounded-lg text-xs font-medium transition",children:"Faith"}),e.jsx("button",{onClick:()=>{$("angel"),T("angel","",null,{wholeWords:!0})},className:"px-2.5 py-1 bg-blue-100 hover:bg-blue-200 text-blue-800 rounded-lg text-xs font-medium transition",children:"Angel"}),e.jsx("button",{onClick:()=>{$('"Holy Ghost" OR "Holy Spirit"'),T('"Holy Ghost" OR "Holy Spirit"',"",null,{wholeWords:!0})},className:"px-2.5 py-1 bg-sky-100 hover:bg-sky-200 text-sky-800 rounded-lg text-xs font-medium transition",children:"Holy Ghost"}),e.jsx("button",{onClick:()=>{$('"divine healing" OR healed OR healing'),T('"divine healing" OR healed OR healing',"",null,{wholeWords:!0})},className:"px-2.5 py-1 bg-green-100 hover:bg-green-200 text-green-800 rounded-lg text-xs font-medium transition",children:"Divine Healing"}),e.jsx("button",{onClick:()=>{$("prophet"),T("prophet","",null,{wholeWords:!0})},className:"px-2.5 py-1 bg-orange-100 hover:bg-orange-200 text-orange-800 rounded-lg text-xs font-medium transition",children:"Prophet"}),e.jsx("button",{onClick:()=>{$('"end time" OR "last days"'),T('"end time" OR "last days"',"",null,{wholeWords:!0})},className:"px-2.5 py-1 bg-rose-100 hover:bg-rose-200 text-rose-800 rounded-lg text-xs font-medium transition",children:"End Time"}),e.jsx("button",{onClick:()=>{$("baptism OR baptized OR baptize"),T("baptism OR baptized OR baptize","",null,{wholeWords:!0})},className:"px-2.5 py-1 bg-cyan-100 hover:bg-cyan-200 text-cyan-800 rounded-lg text-xs font-medium transition",children:"Baptism"}),e.jsx("button",{onClick:()=>{$("bride"),T("bride","",null,{wholeWords:!0})},className:"px-2.5 py-1 bg-pink-100 hover:bg-pink-200 text-pink-800 rounded-lg text-xs font-medium transition",children:"Bride"}),e.jsx("button",{onClick:()=>{$(`"serpent's seed" OR "serpent seed"`),T(`"serpent's seed" OR "serpent seed"`,"",null,{wholeWords:!0})},className:"px-2.5 py-1 bg-lime-100 hover:bg-lime-200 text-lime-800 rounded-lg text-xs font-medium transition",children:"Serpent's Seed"}),e.jsx("button",{onClick:()=>{$('godhead OR trinity OR "oneness"'),T('godhead OR trinity OR "oneness"',"",null,{wholeWords:!0})},className:"px-2.5 py-1 bg-violet-100 hover:bg-violet-200 text-violet-800 rounded-lg text-xs font-medium transition",children:"Godhead"}),e.jsx("button",{onClick:()=>{$("rapture"),T("rapture","",null,{wholeWords:!0})},className:"px-2.5 py-1 bg-fuchsia-100 hover:bg-fuchsia-200 text-fuchsia-800 rounded-lg text-xs font-medium transition",children:"Rapture"}),e.jsx("button",{onClick:()=>{$('"third pull"'),T('"third pull"',"",null,{wholeWords:!0})},className:"px-2.5 py-1 bg-teal-100 hover:bg-teal-200 text-teal-800 rounded-lg text-xs font-medium transition",children:"Third Pull"}),e.jsx("button",{onClick:()=>{$('"seven thunders"'),T('"seven thunders"',"",null,{wholeWords:!0})},className:"px-2.5 py-1 bg-indigo-100 hover:bg-indigo-200 text-indigo-800 rounded-lg text-xs font-medium transition",children:"Seven Thunders"}),e.jsx("button",{onClick:()=>{$("revelation OR revelations"),T("revelation OR revelations","",null,{wholeWords:!0})},className:"px-2.5 py-1 bg-emerald-100 hover:bg-emerald-200 text-emerald-800 rounded-lg text-xs font-medium transition",children:"Revelation"}),w&&e.jsxs("button",{onClick:()=>{ze(""),Pe(""),We(null),ye([]),$("")},className:"px-2.5 py-1 bg-gray-200 hover:bg-gray-300 text-gray-700 rounded-lg text-xs font-medium transition flex items-center gap-1",children:[e.jsx(u,{name:"x",size:12})," Clear Search"]})]}),xe&&G.totalMentions===0&&!lt&&e.jsxs("div",{className:"bg-amber-50 border border-amber-200 rounded-xl p-4 mb-6 flex items-start gap-3",children:[e.jsx("div",{className:"flex-shrink-0 w-10 h-10 bg-amber-100 rounded-full flex items-center justify-center",children:e.jsx(u,{name:"alertCircle",size:20,className:"text-amber-600"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-bold text-amber-800 text-sm",children:"No Results Found"}),e.jsxs("p",{className:"text-amber-700 text-xs mt-1",children:['Your search for "',e.jsx("span",{className:"font-semibold",children:w}),'" did not match any transcripts.']})]})]}),e.jsxs("div",{className:"grid grid-cols-3 md:grid-cols-5 gap-1.5 sm:gap-2 mb-6",children:[e.jsx(Ee,{title:"Sermons",value:G.totalSermons.toLocaleString(),icon:"book",color:"amber",sub:`of ${y.toLocaleString()} total`}),w&&e.jsx(Ee,{title:`"${w}" Matches`,value:G.totalMentions.toLocaleString(),icon:"search",color:G.totalMentions===0?"red":"green",sub:"in filtered results"}),e.jsx(Ee,{title:"Total Words",value:`${(G.totalWords/1e6).toFixed(1)}M`,icon:"fileText",color:"blue",sub:"in filtered sermons"}),e.jsx(Ee,{title:"Total Hours",value:Math.round(G.totalDuration/60).toLocaleString(),icon:"clock",color:"purple",sub:"of preaching"}),G.peakSermon&&w&&e.jsx(Ee,{title:"Peak Mentions",value:G.maxMentions,icon:"activity",color:"orange",sub:"Click to view",onClick:()=>{B({...G.peakSermon,searchTerm:le||w}),H(0)}})]}),e.jsxs("div",{className:"bg-white p-3 sm:p-6 rounded-xl border shadow-sm h-[350px] sm:h-[450px] mb-6 relative",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-2 mb-4",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"font-bold text-gray-800 flex items-center gap-2 text-sm sm:text-base",children:[e.jsx(u,{name:"activity"})," Sermon Timeline (1947-1965)"]}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[w?`Showing "${w}" mentions over time`:"Sermon distribution over time"," â€¢ Click a point to browse"]})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[w&&e.jsxs("button",{onClick:()=>{ze(""),Pe(""),We(null),ye([])},className:"text-xs bg-red-100 text-red-700 hover:bg-red-200 px-3 py-1.5 rounded-lg font-medium flex items-center gap-1 transition-colors",children:[e.jsx(u,{name:"x",size:12})," Clear Search"]}),e.jsx("span",{className:"text-xs text-gray-500",children:"Smoothing:"}),e.jsx("div",{className:"flex bg-gray-100 rounded-lg p-1",children:[{w:4,l:"1 Mo"},{w:12,l:"3 Mo"},{w:26,l:"6 Mo"}].map(({w:t,l:n})=>e.jsx("button",{onClick:()=>_t(t),className:`px-2 py-1 text-xs font-medium rounded ${Ze===t?"bg-white shadow text-amber-600":"text-gray-500"}`,children:n},t))})]})]}),e.jsx(Ct,{width:"100%",height:"85%",children:e.jsxs(Ss,{data:me,onClick:t=>{if(t&&t.activePayload&&t.activePayload[0]){const n=me.find(s=>s.timestamp===t.activePayload[0].payload.timestamp);n&&(et(n),ds({x:t.chartX||200,y:t.chartY||100}))}},children:[e.jsx(St,{strokeDasharray:"3 3",vertical:!1,stroke:"#e5e7eb"}),e.jsx($t,{dataKey:"timestamp",type:"number",scale:"time",domain:hs,tickFormatter:xs,tick:{fontSize:10},minTickGap:80}),e.jsx(Tt,{tick:{fontSize:10},label:{value:w?"Mentions":"Sermons",angle:-90,position:"insideLeft",style:{textAnchor:"middle",fontSize:11,fill:"#6b7280"}}}),e.jsx(Mt,{content:({active:t,payload:n})=>{if(fe||!t||!n||!n.length)return null;const s=n[0].payload,r=`Week of ${new Date(s.timestamp).toLocaleDateString(void 0,{month:"short",day:"numeric",year:"numeric"})}`;return e.jsxs("div",{className:"bg-white p-3 rounded-lg shadow-lg text-sm border border-gray-200",children:[e.jsx("div",{className:"font-bold text-gray-900",children:r}),e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[w?e.jsxs(e.Fragment,{children:[s.mentionCount," mentions â€¢ "]}):null,s.count," sermon",s.count!==1?"s":""]}),e.jsx("div",{className:"mt-2 text-amber-600 text-xs font-medium",children:"Click to browse â†’"})]})}}),e.jsx($s,{wrapperStyle:{fontSize:"11px",paddingTop:"8px"}}),w?e.jsxs(e.Fragment,{children:[e.jsx(Lt,{type:"monotone",dataKey:"mentionCount",name:"Mentions",stroke:"#f59e0b",fill:"#fcd34d",fillOpacity:.6,isAnimationActive:!1,cursor:"pointer"}),e.jsx(Dt,{type:"monotone",dataKey:"rollingAvg",name:"Trend",stroke:"#d97706",strokeWidth:3,dot:!1,isAnimationActive:!1})]}):e.jsxs(e.Fragment,{children:[e.jsx(Lt,{type:"monotone",dataKey:"count",name:"Sermons",stroke:"#f59e0b",fill:"#fcd34d",fillOpacity:.6,isAnimationActive:!1,cursor:"pointer"}),e.jsx(Dt,{type:"monotone",dataKey:"volumeRollingAvg",name:"Trend",stroke:"#d97706",strokeWidth:3,dot:!1,isAnimationActive:!1})]})]})}),fe&&e.jsxs("div",{ref:ms,className:"fixed sm:absolute inset-x-2 sm:inset-x-auto bottom-2 sm:bottom-auto bg-white rounded-xl shadow-2xl border border-gray-200 sm:w-96 max-h-[60vh] sm:max-h-[400px] flex flex-col z-50",style:{left:typeof window<"u"&&window.innerWidth>=640?Math.min(Math.max(16,wt.x-150),window.innerWidth-450):void 0,top:typeof window<"u"&&window.innerWidth>=640?Math.max(60,wt.y+20):void 0},children:[e.jsx("div",{className:"p-4 border-b border-gray-100",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"font-bold text-gray-900",children:["Week of ",new Date(fe.timestamp).toLocaleDateString(void 0,{month:"short",day:"numeric",year:"numeric"})]}),e.jsxs("div",{className:"text-sm text-gray-500 mt-1",children:[fe.sermons?.length||0," sermon",(fe.sermons?.length||0)!==1?"s":""]})]}),e.jsx("button",{onClick:()=>et(null),className:"p-1 hover:bg-gray-100 rounded-full",children:e.jsx(u,{name:"x"})})]})}),e.jsx("div",{className:"text-xs font-medium text-gray-600 px-4 pt-3 pb-2",children:"Click a sermon to view transcript:"}),e.jsx("div",{className:"flex-1 overflow-auto px-3 pb-3",children:e.jsx("div",{className:"space-y-2",children:[...fe.sermons||[]].sort((t,n)=>(n.mentionCount||0)-(t.mentionCount||0)).map((t,n)=>e.jsxs("button",{onClick:()=>{B({...t,searchTerm:le||w}),H(0),et(null)},className:"w-full text-left p-3 bg-amber-50 rounded-lg border border-amber-200 hover:bg-amber-100 hover:border-amber-300 transition-all group",children:[e.jsx("div",{className:"font-medium text-gray-900 group-hover:text-amber-700 line-clamp-2",children:t.title||"Untitled"}),e.jsxs("div",{className:"flex justify-between items-center mt-2 text-xs",children:[e.jsx("span",{className:"text-gray-500",children:t.venue||"Unknown venue"}),e.jsx("span",{className:"text-gray-400",children:new Date(t.timestamp).toLocaleDateString()})]}),w&&t.mentionCount>0&&e.jsxs("div",{className:"mt-1 text-xs text-amber-600 font-medium",children:[t.mentionCount," mentions"]})]},t.id||n))})})]})]}),e.jsxs("div",{className:"bg-white rounded-xl border shadow-sm mb-8 p-4 sm:p-6 overflow-x-auto w-full",children:[e.jsxs("div",{className:"flex flex-col gap-3 mb-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-2",children:[e.jsxs("h3",{className:"font-bold text-gray-800",children:["Sermon Search Results (",U.length.toLocaleString(),")"]}),e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[w&&e.jsxs("div",{className:"text-sm bg-amber-50 text-amber-700 px-3 py-1 rounded font-medium",children:["Searching for: ",e.jsx("span",{className:"font-semibold",children:w})]}),e.jsxs("button",{onClick:()=>be(U,`WMB_All_Transcripts_${U.length}.zip`,`${U.length} sermons`),disabled:S!==null||U.length===0,className:"text-xs bg-amber-500 text-white hover:bg-amber-600 px-3 py-1.5 rounded font-medium flex items-center gap-1 disabled:opacity-50",title:`Download all ${U.length} transcripts as ZIP`,children:[e.jsx(u,{name:"download",size:12})," Download All (",U.length,")"]}),e.jsxs("button",{onClick:ps,className:"text-xs bg-green-100 text-green-700 hover:bg-green-200 px-3 py-1.5 rounded font-medium flex items-center gap-1",title:"Export search results as CSV",children:[e.jsx(u,{name:"download",size:12})," Export CSV"]}),e.jsxs("a",{href:"https://www.livingwordbroadcast.org/wbtextindex",target:"_blank",rel:"noopener noreferrer",className:"text-xs bg-amber-100 text-amber-700 hover:bg-amber-200 px-3 py-1.5 rounded font-medium flex items-center gap-1",children:[e.jsx(u,{name:"externalLink",size:12})," Browse LWB Transcripts"]})]})]}),e.jsxs("div",{className:"relative max-w-md",children:[e.jsx(u,{name:"search",size:14,className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search table by title, venue, date...",value:J.search||"",onChange:t=>Le(n=>({...n,search:t.target.value})),className:"w-full pl-9 pr-8 py-2 text-sm border rounded-lg focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-transparent","data-search-input":!0}),J.search&&e.jsx("button",{onClick:()=>Le(t=>({...t,search:""})),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",children:e.jsx(u,{name:"x",size:14})})]})]}),e.jsx(Ts,{columns:[{key:"date",label:"Date",width:"100px",filterKey:"date",filterPlaceholder:"YYYY",render:t=>t.date},{key:"title",label:"Title",width:"1fr",filterKey:"title",render:t=>e.jsx("div",{className:"flex items-center gap-1",children:e.jsx("span",{className:"text-sm font-medium text-gray-900 truncate block",title:t.title,children:t.title})})},{key:"venue",label:"Venue",width:"200px",filterKey:"venue",hideOnMobile:!0,render:t=>e.jsx("span",{className:"text-xs text-gray-600 truncate",children:t.venue||"â€”"})},{key:"location",label:"Location",width:"140px",hideOnMobile:!0,render:t=>e.jsx("span",{className:"text-xs text-gray-500",children:t.location||"â€”"})},...w?[{key:"mentionCount",label:"Mentions",width:"80px",render:t=>e.jsx("span",{className:`text-xs font-bold ${t.mentionCount>0?"text-amber-600":"text-gray-400"}`,children:t.mentionCount||0})}]:[],{key:"readTime",label:"Read Time",width:"75px",hideOnMobile:!0,render:t=>{const n=Math.round((t.wordCount||0)/st);return e.jsx("span",{className:"text-xs text-gray-500",children:n>60?`${Math.round(n/60)}h ${n%60}m`:`${n}m`})}},{key:"wordCount",label:"Words",width:"90px",hideOnMobile:!0,render:t=>e.jsx("span",{className:"text-xs text-gray-500",children:t.wordCount?.toLocaleString()||"â€”"})},{key:"download",label:"Download",width:"90px",render:t=>t.path?e.jsxs("a",{href:`/wmbmentions.github.io/${Ve(t.path)}`,download:!0,onClick:s=>s.stopPropagation(),className:"text-xs text-blue-600 hover:text-blue-800 font-medium flex items-center gap-1",children:[e.jsx(u,{name:"download",size:12})," TXT"]}):"â€”"}],data:U,filters:J,onFilterChange:(t,n)=>Le(s=>({...s,[t]:n})),sortConfig:de,onSort:t=>Qe(n=>({key:t,direction:n.key===t&&n.direction==="asc"?"desc":"asc"})),onRowClick:t=>{B({...t,searchTerm:le||w}),H(0)},rowHeight:48})]}),e.jsxs("div",{className:"bg-white rounded-xl border shadow-sm p-6",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-800 mb-4",children:"Archive Statistics"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-amber-50 p-4 rounded-lg",children:[e.jsx("div",{className:"text-3xl font-bold text-amber-700",children:y.toLocaleString()}),e.jsx("div",{className:"text-sm text-amber-600",children:"Total Sermons"})]}),e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[e.jsxs("div",{className:"text-3xl font-bold text-blue-700",children:[(rt/1e6).toFixed(1),"M"]}),e.jsx("div",{className:"text-sm text-blue-600",children:"Total Words"})]}),e.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg",children:[e.jsx("div",{className:"text-3xl font-bold text-purple-700",children:Math.round(Wt/60).toLocaleString()}),e.jsx("div",{className:"text-sm text-purple-600",children:"Hours of Preaching"})]}),e.jsxs("div",{className:"bg-green-50 p-4 rounded-lg",children:[e.jsx("div",{className:"text-3xl font-bold text-green-700",children:ot.length}),e.jsx("div",{className:"text-sm text-green-600",children:"Unique Venues"})]})]}),e.jsxs("div",{className:"mb-6 p-4 bg-indigo-50 rounded-lg border border-indigo-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("h3",{className:"text-lg font-bold text-indigo-800 flex items-center gap-2",children:[e.jsx(u,{name:"book",size:18})," Scripture References"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[Z&&e.jsxs("div",{className:"flex bg-white rounded-lg border overflow-hidden",children:[e.jsx("button",{onClick:()=>Ye("grid"),className:`px-3 py-1.5 text-sm font-medium transition-colors ${Fe==="grid"?"bg-indigo-600 text-white":"text-gray-600 hover:bg-gray-100"}`,children:"Grid"}),e.jsx("button",{onClick:()=>Ye("heatmap"),className:`px-3 py-1.5 text-sm font-medium transition-colors ${Fe==="heatmap"?"bg-indigo-600 text-white":"text-gray-600 hover:bg-gray-100"}`,children:"Heatmap"})]}),!Z&&e.jsx("button",{onClick:cs,disabled:Re,className:"px-4 py-2 bg-indigo-600 text-white rounded-lg text-sm font-medium hover:bg-indigo-700 disabled:opacity-50 flex items-center gap-2",children:Re?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"})," Scanning..."]}):e.jsxs(e.Fragment,{children:[e.jsx(u,{name:"search",size:14})," Scan Transcripts"]})})]})]}),!Z&&!Re&&e.jsx("p",{className:"text-sm text-indigo-600",children:'Click "Scan Transcripts" to find all Bible references mentioned across the archive. This may take a few minutes.'}),Z&&Fe==="grid"&&e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm text-indigo-600 mb-3",children:["Found references to ",Z.length," books of the Bible"]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-2 max-h-64 overflow-y-auto",children:Z.slice(0,24).map(({book:t,count:n,refs:s})=>{const r=He.has(`scripture-${t}`);return e.jsxs("div",{className:"bg-white rounded border overflow-hidden",children:[e.jsxs("button",{onClick:()=>$e(o=>{const l=new Set(o),a=`scripture-${t}`;return l.has(a)?l.delete(a):l.add(a),l}),className:`w-full p-2 flex justify-between items-center text-sm ${r?"bg-indigo-100":"hover:bg-gray-50"}`,children:[e.jsx("span",{className:"font-medium text-gray-800 truncate",children:t}),e.jsx("span",{className:"text-xs text-indigo-600 ml-1",children:n.toLocaleString()})]}),r&&e.jsx("div",{className:"border-t p-2 text-xs space-y-1 max-h-40 overflow-y-auto bg-gray-50",children:s.map(({ref:o,count:l})=>e.jsxs("button",{onClick:()=>{$(o),T(o,"",null,{wholeWords:!1})},className:"w-full text-left px-2 py-1 hover:bg-indigo-100 rounded flex justify-between",children:[e.jsx("span",{className:"truncate",children:o}),e.jsxs("span",{className:"text-indigo-500 ml-1",children:["(",l,")"]})]},o))})]},t)})})]}),Z&&Fe==="heatmap"&&(()=>{const t=["Genesis","Exodus","Leviticus","Numbers","Deuteronomy","Joshua","Judges","Ruth","1 Samuel","2 Samuel","1 Kings","2 Kings","1 Chronicles","2 Chronicles","Ezra","Nehemiah","Esther","Job","Psalms","Proverbs","Ecclesiastes","Song of Solomon","Isaiah","Jeremiah","Lamentations","Ezekiel","Daniel","Hosea","Joel","Amos","Obadiah","Jonah","Micah","Nahum","Habakkuk","Zephaniah","Haggai","Zechariah","Malachi"],n=["Matthew","Mark","Luke","John","Acts","Romans","1 Corinthians","2 Corinthians","Galatians","Ephesians","Philippians","Colossians","1 Thessalonians","2 Thessalonians","1 Timothy","2 Timothy","Titus","Philemon","Hebrews","James","1 Peter","2 Peter","1 John","2 John","3 John","Jude","Revelation"],s=Math.max(...Z.map(l=>l.count)),r=new Map(Z.map(l=>[l.book,l])),o=(l,a)=>l.filter(i=>r.has(i)).length===0?null:e.jsxs("div",{className:"mb-4",children:[e.jsx("h4",{className:"text-xs font-bold text-indigo-700 mb-2",children:a}),e.jsx("div",{className:"flex flex-wrap gap-1",children:l.map(i=>{const m=r.get(i),h=m?.count||0,g=h>0?Math.min(.15+h/s*.85,1):0;return e.jsx("button",{onClick:()=>{m&&($e(k=>{const b=new Set(k),v=`scripture-${i}`;return b.has(v)?b.delete(v):b.add(v),b}),Ye("grid"))},className:`px-2 py-1 rounded text-xs font-medium transition-colors ${h>0?"cursor-pointer hover:ring-1 hover:ring-indigo-400":"cursor-default opacity-30"}`,style:{backgroundColor:h>0?`rgba(79, 70, 229, ${g})`:"#e5e7eb",color:g>.5?"white":h>0?"#3730a3":"#9ca3af"},title:h>0?`${i}: ${h.toLocaleString()} references`:`${i}: No references found`,children:i.length>10?i.slice(0,8)+"...":i},i)})})]},a);return e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm text-indigo-600 mb-3",children:["Found references to ",Z.length," books of the Bible. Click a book to see specific verses."]}),o(t,"Old Testament"),o(n,"New Testament"),e.jsxs("div",{className:"flex items-center justify-end gap-2 mt-3 text-xs text-gray-500",children:[e.jsx("span",{children:"Fewer"}),e.jsx("div",{className:"flex",children:[.15,.35,.55,.75,.95].map((l,a)=>e.jsx("div",{className:"w-5 h-4",style:{backgroundColor:`rgba(79, 70, 229, ${l})`}},a))}),e.jsx("span",{children:"More references"})]})]})})()]}),e.jsx("h3",{className:"text-lg font-bold text-gray-800 mb-3",children:"Featured Sermon Series"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 mb-6",children:Object.entries(Xe).map(([t,n])=>{const s=ls(t),r=He.has(t),o={amber:{bg:"bg-amber-50",border:"border-amber-200",header:"bg-amber-100",text:"text-amber-800",badge:"bg-amber-600"},indigo:{bg:"bg-indigo-50",border:"border-indigo-200",header:"bg-indigo-100",text:"text-indigo-800",badge:"bg-indigo-600"}}[n.color]||{bg:"bg-gray-50",border:"border-gray-200",header:"bg-gray-100",text:"text-gray-800",badge:"bg-gray-600"};return e.jsxs("div",{className:`rounded-lg border ${o.border} overflow-hidden`,children:[e.jsxs("button",{onClick:()=>$e(l=>{const a=new Set(l);return a.has(t)?a.delete(t):a.add(t),a}),className:`w-full p-3 ${o.header} flex items-center justify-between transition hover:opacity-90`,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(u,{name:"book",size:18,className:o.text}),e.jsx("span",{className:`font-bold ${o.text}`,children:t}),e.jsxs("span",{className:`text-xs px-2 py-0.5 rounded-full text-white ${o.badge}`,children:[s.length," sermons"]})]}),e.jsx(u,{name:r?"chevronUp":"chevronDown",size:18,className:o.text})]}),r&&e.jsxs("div",{className:`${o.bg} p-3`,children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("p",{className:"text-xs text-gray-500",children:n.description}),e.jsx("div",{className:"flex gap-1 flex-shrink-0 ml-2",children:e.jsxs("button",{onClick:l=>{l.stopPropagation(),be(s,`WMB_${t.replace(/[^a-zA-Z0-9]+/g,"_")}.zip`,t)},disabled:S!==null,className:"px-2 py-0.5 text-xs bg-amber-500 text-white rounded hover:bg-amber-600 transition disabled:opacity-50 flex items-center gap-1",title:`Download all ${s.length} sermons as ZIP`,children:[e.jsx(u,{name:"download",size:12})," ZIP (",s.length,")"]})})]}),e.jsx("div",{className:"space-y-1",children:s.map(l=>e.jsxs("button",{onClick:()=>{B(l),H(0)},className:"w-full text-left p-2 bg-white rounded border hover:bg-gray-50 transition flex justify-between items-center group",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"font-medium text-gray-800 text-sm truncate",children:l.title}),e.jsx("div",{className:"text-xs text-gray-500",children:l.date})]}),e.jsx(u,{name:"chevronRight",size:14,className:"text-gray-400 group-hover:text-gray-600 flex-shrink-0 ml-2"})]},l.id))})]})]},t)})}),e.jsx("h3",{className:"text-lg font-bold text-gray-800 mb-3",children:"Top Topics"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-2",children:Object.entries(Bt).slice(0,12).map(([t,n])=>{const s=He.has(`topic-${t}`),r=`topic-${t}`,o=pt[r]||"",l=x.filter(d=>d.topics&&d.topics.includes(t)).sort((d,i)=>(d.date||"").localeCompare(i.date||"")),a=s?o?l.filter(d=>d.title.toLowerCase().includes(o.toLowerCase())||(d.date||"").includes(o)):l:[];return e.jsxs("div",{className:"border rounded-lg overflow-hidden",children:[e.jsxs("button",{onClick:()=>$e(d=>{const i=new Set(d),m=`topic-${t}`;return i.has(m)?i.delete(m):i.add(m),i}),className:`w-full p-3 flex justify-between items-center transition ${s?"bg-gray-100":"bg-gray-50 hover:bg-gray-100"}`,children:[e.jsx("span",{className:"font-medium text-gray-700",children:t}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-sm text-gray-500",children:[n," sermons"]}),e.jsx(u,{name:s?"chevronUp":"chevronDown",size:14,className:"text-gray-400"})]})]}),s&&e.jsxs("div",{className:"bg-white border-t max-h-80 overflow-y-auto",children:[e.jsxs("div",{className:"sticky top-0 bg-gray-50 p-2 border-b space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("span",{className:"text-xs text-gray-500",children:[a.length," sermons",o&&" (filtered)"]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsxs("button",{onClick:d=>{d.stopPropagation(),be(a,`WMB_${t.replace(/[^a-zA-Z0-9]+/g,"_")}_Sermons.zip`,t)},disabled:S!==null,className:"px-2 py-0.5 text-xs bg-amber-500 text-white rounded hover:bg-amber-600 transition disabled:opacity-50 flex items-center gap-1",title:`Download all ${a.length} sermons about ${t} as ZIP`,children:[e.jsx(u,{name:"download",size:12})," ZIP (",a.length,")"]}),e.jsx("button",{onClick:d=>{d.stopPropagation();const i=a.map(k=>`${k.date} - ${k.title}`).join(`
`),m=new Blob([i],{type:"text/plain"}),h=URL.createObjectURL(m),g=document.createElement("a");g.href=h,g.download=`WMB_${t.replace(/[^a-zA-Z0-9]+/g,"_")}_Index.txt`,g.click(),URL.revokeObjectURL(h)},className:"px-2 py-0.5 text-xs bg-gray-400 text-white rounded hover:bg-gray-500 transition",title:`Download index of ${a.length} sermons`,children:"Index"})]})]}),e.jsx("input",{type:"text",placeholder:"Search sermons...",value:o,onClick:d=>d.stopPropagation(),onChange:d=>bt(i=>({...i,[r]:d.target.value})),className:"w-full text-xs border rounded px-2 py-1 focus:outline-none focus:ring-1 focus:ring-amber-500"})]}),e.jsxs("div",{className:"p-2",children:[a.map(d=>e.jsxs("div",{className:"flex items-center gap-1 hover:bg-gray-50 rounded transition",children:[e.jsxs("button",{onClick:()=>{B(d),H(0)},className:"flex-1 text-left p-2 flex justify-between items-center text-sm min-w-0",children:[e.jsx("span",{className:"truncate text-gray-800",children:d.title}),e.jsx("span",{className:"text-xs text-gray-500 ml-2 flex-shrink-0",children:d.date})]}),e.jsx("a",{href:d.lwbUrl||"https://www.livingwordbroadcast.org/wbtextindex",target:"_blank",rel:"noopener noreferrer",title:"Download from Living Word Broadcast",className:"p-2 text-gray-400 hover:text-amber-600 flex-shrink-0",children:e.jsx(u,{name:"download",size:14})})]},d.id)),a.length===0&&o&&e.jsxs("p",{className:"text-xs text-gray-400 text-center py-4",children:['No sermons match "',o,'"']})]})]})]},t)})})]}),e.jsxs("div",{className:"bg-white rounded-xl border shadow-sm p-6",children:[e.jsxs("h2",{className:"text-xl font-bold text-gray-800 mb-4",children:[e.jsx(u,{name:"location",className:"inline mr-2",size:20}),"Browse by Venue (",ot.length,")"]}),e.jsx("p",{className:"text-sm text-gray-500 mb-4",children:"Click a venue to see all sermons preached there"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-2 max-h-96 overflow-y-auto",children:X.slice(0,30).map(t=>{const n=He.has(`venue-${t.venue}`),s=`venue-${t.venue}`,r=pt[s]||"",o=x.filter(a=>a.venue===t.venue).sort((a,d)=>(a.date||"").localeCompare(d.date||"")),l=n?r?o.filter(a=>a.title.toLowerCase().includes(r.toLowerCase())||(a.date||"").includes(r)):o:[];return e.jsxs("div",{className:"border rounded-lg overflow-hidden",children:[e.jsxs("button",{onClick:()=>$e(a=>{const d=new Set(a),i=`venue-${t.venue}`;return d.has(i)?d.delete(i):d.add(i),d}),className:`w-full p-3 flex justify-between items-center transition ${n?"bg-blue-50":"bg-gray-50 hover:bg-gray-100"}`,children:[e.jsxs("div",{className:"text-left min-w-0 flex-1",children:[e.jsx("span",{className:"font-medium text-gray-700 truncate block",children:t.venue}),t.dateRange&&t.dateRange!=="N/A"&&e.jsx("span",{className:"text-xs text-gray-400",children:t.dateRange})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0 ml-2",children:[e.jsx("span",{className:"text-sm text-gray-500",children:t.count}),e.jsx(u,{name:n?"chevronUp":"chevronDown",size:14,className:"text-gray-400"})]})]}),n&&e.jsxs("div",{className:"bg-white border-t max-h-80 overflow-y-auto",children:[e.jsxs("div",{className:"sticky top-0 bg-gray-50 p-2 border-b",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsxs("span",{className:"text-xs text-gray-500",children:[l.length,r?` of ${o.length}`:""," sermons"]}),e.jsx("div",{className:"flex gap-1",children:e.jsxs("button",{onClick:a=>{a.stopPropagation(),be(o,`WMB_${t.venue.replace(/[^a-zA-Z0-9]+/g,"_")}_Sermons.zip`,t.venue)},disabled:S!==null,className:"px-2 py-0.5 text-xs bg-amber-500 text-white rounded hover:bg-amber-600 transition disabled:opacity-50 flex items-center gap-1",title:`Download all ${o.length} sermons from ${t.venue} as ZIP`,children:[e.jsx(u,{name:"download",size:12})," ZIP"]})})]}),e.jsx("input",{type:"text",placeholder:"Search sermons...",value:r,onChange:a=>bt(d=>({...d,[s]:a.target.value})),onClick:a=>a.stopPropagation(),className:"w-full px-2 py-1 text-xs border rounded focus:outline-none focus:ring-1 focus:ring-blue-500"})]}),e.jsxs("div",{className:"p-2",children:[l.map(a=>e.jsxs("button",{onClick:()=>{B(a),H(0)},className:"w-full text-left p-2 hover:bg-gray-50 rounded transition flex justify-between items-center text-sm",children:[e.jsx("span",{className:"truncate text-gray-800 flex-1 min-w-0",children:a.title}),e.jsx("span",{className:"text-xs text-gray-500 ml-2 flex-shrink-0",children:a.date})]},a.id)),l.length===0&&r&&e.jsxs("p",{className:"text-xs text-gray-400 text-center py-2",children:['No sermons match "',r,'"']})]})]})]},t.venue)})})]})]}),Ce==="data"&&e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-white rounded-xl border shadow-sm p-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-3 mb-4",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl font-bold text-gray-800",children:[e.jsx(u,{name:"calendar",className:"inline mr-2",size:20}),"All Transcripts by Year"]}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Click a year to expand and see all sermons. Click a sermon to view its full transcript."})]}),e.jsx("div",{className:"flex gap-2",children:e.jsxs("button",{onClick:()=>be(x,"WMB_All_Sermons.zip","all"),disabled:S!==null,className:"px-4 py-2 bg-amber-600 hover:bg-amber-700 disabled:bg-amber-400 text-white rounded-lg text-sm font-medium transition flex items-center gap-2 whitespace-nowrap",children:[e.jsx(u,{name:"download",size:16}),S?.year==="all"?`Downloading ${S.current}/${S.total}...`:`Download All (${x.length})`]})})]}),S&&e.jsx("div",{className:"mb-4 bg-amber-50 border border-amber-200 rounded-lg p-3",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"animate-spin w-5 h-5 border-2 border-amber-600 border-t-transparent rounded-full"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"text-sm font-medium text-amber-800",children:["Downloading ",S.year==="all"?"all transcripts":`${S.year} transcripts`,"..."]}),e.jsxs("div",{className:"text-xs text-amber-600",children:[S.current," of ",S.total," files"]})]}),e.jsx("div",{className:"w-32 bg-amber-200 rounded-full h-2",children:e.jsx("div",{className:"bg-amber-600 h-2 rounded-full transition-all",style:{width:`${S.current/S.total*100}%`}})})]})}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("button",{onClick:()=>ts(!Je),className:"flex items-center gap-2 text-sm font-medium text-amber-600 hover:text-amber-800 mb-3",children:[e.jsx(u,{name:Je?"chevronDown":"chevronRight",size:16}),e.jsx(u,{name:"search",size:14}),Je?"Hide":"Open"," Searchable Sermon Database (",x.length.toLocaleString()," sermons)"]}),Je&&e.jsxs("div",{className:"border rounded-lg p-4 bg-amber-50",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 mb-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(u,{name:"search",size:14,className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Filter by title, venue, location, date...",value:qe,onChange:t=>ft(t.target.value),className:"w-full pl-9 pr-8 py-2 text-sm border rounded-lg focus:outline-none focus:ring-2 focus:ring-amber-500"}),qe&&e.jsx("button",{onClick:()=>ft(""),className:"absolute right-2 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",children:e.jsx(u,{name:"x",size:14})})]}),e.jsx("div",{className:"text-xs text-gray-500",children:"Filters metadata only. Use the search engine on the Search & Stats tab to search sermon content."})]}),(()=>{const t=qe.trim().toLowerCase();let n=x.slice();t&&(n=n.filter(a=>(a.title||"").toLowerCase().includes(t)||(a.venue||"").toLowerCase().includes(t)||(a.location||"").toLowerCase().includes(t)||(a.date||"").toLowerCase().includes(t)));const s=ss;n.sort((a,d)=>{let i=a[s.key]||"",m=d[s.key]||"";if(s.key==="date"&&(i||(i="0000-00-00"),m||(m="0000-00-00")),s.key==="wordCount"){i=a.wordCount||0,m=d.wordCount||0;const g=i-m;return s.direction==="desc"?-g:g}const h=String(i).localeCompare(String(m));return s.direction==="desc"?-h:h});const r=100,o=n.length>r,l=n.slice(0,r);return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-xs text-gray-500 mb-2",children:t?e.jsxs(e.Fragment,{children:["Showing ",l.length.toLocaleString(),o?"+":""," of ",n.length.toLocaleString()," matching sermons"]}):e.jsxs(e.Fragment,{children:["Showing ",l.length.toLocaleString()," of ",x.length.toLocaleString()," sermons (use search to filter)"]})}),e.jsx("div",{className:"max-h-96 overflow-y-auto border rounded bg-white overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm min-w-[800px]",children:[e.jsx("thead",{className:"sticky top-0 bg-gray-50 border-b z-10",children:e.jsxs("tr",{className:"text-gray-600 text-left",children:[e.jsxs("th",{className:"p-2 font-medium w-24 cursor-pointer hover:bg-gray-100 select-none",onClick:()=>Me(a=>({key:"date",direction:a.key==="date"&&a.direction==="desc"?"asc":"desc"})),children:["Date ",s.key==="date"&&e.jsx("span",{className:"ml-1",children:s.direction==="desc"?"â†“":"â†‘"})]}),e.jsxs("th",{className:"p-2 font-medium cursor-pointer hover:bg-gray-100 select-none",onClick:()=>Me(a=>({key:"title",direction:a.key==="title"&&a.direction==="asc"?"desc":"asc"})),children:["Title ",s.key==="title"&&e.jsx("span",{className:"ml-1",children:s.direction==="asc"?"â†‘":"â†“"})]}),e.jsxs("th",{className:"p-2 font-medium hidden sm:table-cell cursor-pointer hover:bg-gray-100 select-none",onClick:()=>Me(a=>({key:"venue",direction:a.key==="venue"&&a.direction==="asc"?"desc":"asc"})),children:["Venue ",s.key==="venue"&&e.jsx("span",{className:"ml-1",children:s.direction==="asc"?"â†‘":"â†“"})]}),e.jsxs("th",{className:"p-2 font-medium hidden md:table-cell cursor-pointer hover:bg-gray-100 select-none",onClick:()=>Me(a=>({key:"location",direction:a.key==="location"&&a.direction==="asc"?"desc":"asc"})),children:["Location ",s.key==="location"&&e.jsx("span",{className:"ml-1",children:s.direction==="asc"?"â†‘":"â†“"})]}),e.jsxs("th",{className:"p-2 font-medium text-right hidden md:table-cell cursor-pointer hover:bg-gray-100 select-none",onClick:()=>Me(a=>({key:"wordCount",direction:a.key==="wordCount"&&a.direction==="desc"?"asc":"desc"})),children:["Words ",s.key==="wordCount"&&e.jsx("span",{className:"ml-1",children:s.direction==="desc"?"â†“":"â†‘"})]}),e.jsx("th",{className:"p-2 font-medium text-center",children:"Source"}),e.jsx("th",{className:"p-2 font-medium text-center",children:"Download"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100",children:l.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"7",className:"py-8 text-center text-gray-500",children:"No sermons match your search."})}):l.map((a,d)=>e.jsxs("tr",{className:"hover:bg-amber-50 cursor-pointer",onClick:()=>B(a),children:[e.jsx("td",{className:"p-2 text-gray-600 whitespace-nowrap",children:a.date||"Unknown"}),e.jsx("td",{className:"p-2 font-medium text-gray-800",children:a.title||"Untitled"}),e.jsx("td",{className:"p-2 text-gray-600 hidden sm:table-cell",children:a.venue||"â€”"}),e.jsx("td",{className:"p-2 text-gray-600 hidden md:table-cell",children:a.location||"â€”"}),e.jsx("td",{className:"p-2 text-right text-gray-500 hidden md:table-cell",children:a.wordCount?.toLocaleString()||"â€”"}),e.jsx("td",{className:"p-2 text-center",children:e.jsx("a",{href:"https://www.livingwordbroadcast.org/wbtextindex",target:"_blank",rel:"noopener noreferrer",onClick:i=>i.stopPropagation(),className:"text-xs text-amber-600 hover:text-amber-800 font-medium",children:"LWB â†—"})}),e.jsx("td",{className:"p-2 text-center",children:a.path&&e.jsxs("a",{href:`/wmbmentions.github.io/${Ve(a.path)}`,download:!0,onClick:i=>i.stopPropagation(),className:"text-xs text-blue-600 hover:text-blue-800 font-medium inline-flex items-center gap-1",title:"Download transcript",children:[e.jsx(u,{name:"download",size:12})," TXT"]})})]},d))})]})}),o&&e.jsxs("div",{className:"text-xs text-gray-500 mt-2 text-center",children:["Showing first ",r," results. Use search to narrow down."]})]})})()]})]}),e.jsx("div",{className:"space-y-2",children:us.map(({year:t,sermons:n,count:s,totalWords:r})=>{const o=Yt.has(t),l=Xt[t]||"",a=Qt[t]||{key:"date",direction:"asc"},d=n.filter(i=>{if(!l)return!0;const m=l.toLowerCase();return(i.title||"").toLowerCase().includes(m)||(i.venue||"").toLowerCase().includes(m)||(i.date||"").toLowerCase().includes(m)}).sort((i,m)=>{const h=a.direction==="asc"?1:-1;return a.key==="date"?h*(i.date||"").localeCompare(m.date||""):a.key==="title"?h*(i.title||"").localeCompare(m.title||""):a.key==="venue"?h*(i.venue||"").localeCompare(m.venue||""):0});return e.jsxs("div",{className:"border rounded-lg overflow-hidden",children:[e.jsxs("div",{className:`flex items-center justify-between p-4 transition-colors ${o?"bg-amber-100":"bg-amber-50 hover:bg-amber-100"}`,children:[e.jsxs("button",{onClick:()=>{qt(i=>{const m=new Set(i);return m.has(t)?m.delete(t):m.add(t),m})},className:"flex items-center gap-3 flex-1 text-left",children:[e.jsx(u,{name:o?"chevronDown":"chevronRight",size:18,className:"text-amber-600"}),e.jsx("span",{className:"text-lg font-bold text-amber-800",children:t}),e.jsxs("span",{className:"text-sm text-amber-600",children:["(",s," sermons)"]}),e.jsxs("span",{className:"text-sm text-amber-700 ml-auto mr-4",children:[(r/1e3).toFixed(0),"K words"]})]}),e.jsxs("button",{onClick:i=>{i.stopPropagation();const m=n.filter(v=>v.path);if(m.length===0){alert("No downloadable transcripts for this year");return}const h=`William Branham Sermons - ${t}
${"=".repeat(40)}

${m.length} sermons

Download each transcript from Living Word Broadcast:
https://www.livingwordbroadcast.org/wbtextindex

--- Sermon List ---

${m.map(v=>`${v.date} - ${v.title}
  Venue: ${v.venue||"Unknown"}
  Words: ${v.wordCount?.toLocaleString()||"N/A"}`).join(`

`)}`,g=new Blob([h],{type:"text/plain"}),k=URL.createObjectURL(g),b=document.createElement("a");b.href=k,b.download=`WMB_Sermons_${t}_Index.txt`,document.body.appendChild(b),b.click(),document.body.removeChild(b),URL.revokeObjectURL(k)},className:"px-2 py-1.5 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded text-xs font-medium transition flex items-center gap-1",title:`Download index for ${t}`,children:[e.jsx(u,{name:"fileText",size:12})," Index"]}),e.jsxs("button",{onClick:i=>{i.stopPropagation(),be(n,`WMB_Sermons_${t}.zip`,t)},disabled:S!==null,className:"px-2 py-1.5 bg-amber-600 hover:bg-amber-700 disabled:bg-amber-400 text-white rounded text-xs font-medium transition flex items-center gap-1",title:`Download all ${s} transcripts for ${t} as ZIP`,children:[e.jsx(u,{name:"download",size:12}),S?.year===t?`${S.current}/${S.total}`:`ZIP (${s})`]})]}),o&&e.jsxs("div",{className:"bg-white border-t p-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 mb-3",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(u,{name:"search",size:14,className:"absolute left-2 top-1/2 -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search sermons by title, venue, or date...",value:l,onChange:i=>gt(m=>({...m,[t]:i.target.value})),className:"w-full pl-7 pr-3 py-1.5 text-sm border rounded focus:outline-none focus:ring-1 focus:ring-amber-500"}),l&&e.jsx("button",{onClick:()=>gt(i=>({...i,[t]:""})),className:"absolute right-2 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",children:e.jsx(u,{name:"x",size:12})})]}),e.jsxs("div",{className:"flex gap-1 text-xs",children:[e.jsx("span",{className:"text-gray-500 self-center mr-1",children:"Sort:"}),["date","title","venue"].map(i=>e.jsxs("button",{onClick:()=>es(m=>({...m,[t]:{key:i,direction:m[t]?.key===i&&m[t]?.direction==="asc"?"desc":"asc"}})),className:`px-2 py-1 rounded ${a.key===i?"bg-amber-100 text-amber-700":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:[i.charAt(0).toUpperCase()+i.slice(1),a.key===i&&(a.direction==="asc"?" â†‘":" â†“")]},i))]})]}),e.jsxs("div",{className:"max-h-96 overflow-y-auto overflow-x-auto",children:[e.jsxs("table",{className:"w-full text-sm min-w-[800px]",children:[e.jsx("thead",{className:"bg-gray-50 sticky top-0",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left p-2 font-medium text-gray-600",children:"Date"}),e.jsx("th",{className:"text-left p-2 font-medium text-gray-600",children:"Title"}),e.jsx("th",{className:"text-left p-2 font-medium text-gray-600 hidden sm:table-cell",children:"Venue"}),e.jsx("th",{className:"text-left p-2 font-medium text-gray-600 hidden md:table-cell",children:"Location"}),e.jsx("th",{className:"text-right p-2 font-medium text-gray-600 hidden md:table-cell",children:"Words"}),e.jsx("th",{className:"text-center p-2 font-medium text-gray-600",children:"Source"}),e.jsx("th",{className:"text-center p-2 font-medium text-gray-600",children:"Download"})]})}),e.jsx("tbody",{children:d.map((i,m)=>e.jsxs("tr",{onClick:()=>{B(i),H(0)},className:"border-t cursor-pointer hover:bg-amber-50 transition-colors",children:[e.jsx("td",{className:"p-2 text-gray-600 whitespace-nowrap",children:i.date}),e.jsx("td",{className:"p-2 font-medium text-gray-800",children:i.title}),e.jsx("td",{className:"p-2 text-gray-600 hidden sm:table-cell",children:i.venue}),e.jsx("td",{className:"p-2 text-gray-600 hidden md:table-cell",children:i.location||"â€”"}),e.jsx("td",{className:"p-2 text-gray-500 text-right hidden md:table-cell",children:i.wordCount?.toLocaleString()}),e.jsx("td",{className:"p-2 text-center",children:e.jsx("a",{href:"https://www.livingwordbroadcast.org/wbtextindex",target:"_blank",rel:"noopener noreferrer",onClick:h=>h.stopPropagation(),className:"text-xs text-amber-600 hover:text-amber-800 font-medium",children:"LWB â†—"})}),e.jsx("td",{className:"p-2 text-center",children:i.path&&e.jsxs("a",{href:`/wmbmentions.github.io/${Ve(i.path)}`,download:!0,onClick:h=>h.stopPropagation(),className:"text-xs text-blue-600 hover:text-blue-800 font-medium inline-flex items-center gap-1",children:[e.jsx(u,{name:"download",size:12})," TXT"]})})]},i.id||m))})]}),d.length===0&&e.jsx("div",{className:"text-center py-4 text-gray-500",children:"No sermons match your search."})]}),e.jsxs("div",{className:"text-xs text-gray-500 mt-2 pt-2 border-t",children:["Showing ",d.length," of ",s," sermons"]})]})]},t)})})]})}),Ce==="about"&&e.jsxs("div",{className:"bg-white rounded-xl border shadow-sm p-6",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-800 mb-4",children:"About This Archive"}),e.jsxs("div",{className:"prose prose-sm max-w-none text-gray-600",children:[e.jsxs("p",{children:["This searchable archive contains ",e.jsxs("strong",{children:[y.toLocaleString()," sermon transcripts"]})," from William Branham's ministry spanning ",e.jsx("strong",{children:nt}),"."]}),e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mt-6 mb-2",children:"Features"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Full-text search"})," with regex and boolean operators (AND, OR, NOT, NEAR)"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Topic filtering"})," by detected sermon themes"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Timeline visualization"})," of sermons and search results"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Venue breakdown"})," showing where sermons were preached"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Direct links"})," to Living Word Broadcast for each sermon"]})]}),e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mt-6 mb-2",children:"Data Source"}),e.jsxs("p",{children:["All transcripts are sourced from ",e.jsx("a",{href:"https://www.livingwordbroadcast.org/wbtextindex",target:"_blank",rel:"noopener noreferrer",className:"text-amber-600 hover:text-amber-800",children:"Living Word Broadcast"}),"."]}),e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mt-6 mb-2",children:"Search Tips"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[e.jsxs("li",{children:[e.jsx("code",{className:"bg-gray-100 px-1 rounded",children:"seven seals"})," - Find exact phrase"]}),e.jsxs("li",{children:[e.jsx("code",{className:"bg-gray-100 px-1 rounded",children:"bride AND rapture"})," - Both terms required"]}),e.jsxs("li",{children:[e.jsx("code",{className:"bg-gray-100 px-1 rounded",children:"prophet OR messenger"})," - Either term"]}),e.jsxs("li",{children:[e.jsx("code",{className:"bg-gray-100 px-1 rounded",children:"healing NOT cancer"})," - Exclude a term"]}),e.jsxs("li",{children:[e.jsx("code",{className:"bg-gray-100 px-1 rounded",children:"seal* "})," - Wildcard (seals, sealed, etc.)"]})]})]})]})]}),ce&&e.jsx(Ms,{sermon:ce,searchTerm:ce.searchTerm,wholeWords:it.current?.wholeWords!==!1,onClose:()=>B(null),focusIndex:Zt,onFocusChange:H,onSaveProgress:rs,resumePosition:ce.resumePosition,relatedSermons:is(ce),onSelectRelated:t=>{B({...t,searchTerm:le||w}),H(0)}}),Se&&(()=>{const t=x.filter(s=>s.venue===Se).sort((s,r)=>(s.date||"").localeCompare(r.date||"")),n=X.find(s=>s.venue===Se);return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",onClick:()=>Ie(null),children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-2xl w-full max-h-[80vh] overflow-hidden",onClick:s=>s.stopPropagation(),children:[e.jsxs("div",{className:"bg-gradient-to-r from-amber-500 to-amber-600 text-white p-4 flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-lg",children:Se}),e.jsxs("p",{className:"text-amber-100 text-sm",children:[t.length," sermons â€¢ ",n?.dateRange||"Unknown dates"]})]}),e.jsx("button",{onClick:()=>Ie(null),className:"text-white/80 hover:text-white p-1",children:e.jsx(u,{name:"x",size:24})})]}),e.jsx("div",{className:"p-4 overflow-y-auto max-h-[calc(80vh-80px)]",children:e.jsx("div",{className:"space-y-1",children:t.map(s=>e.jsxs("button",{onClick:()=>{B(s),H(0),Ie(null)},className:"w-full text-left p-3 hover:bg-amber-50 rounded-lg transition flex justify-between items-center border border-transparent hover:border-amber-200",children:[e.jsx("span",{className:"text-gray-800 flex-1 min-w-0 truncate",children:s.title}),e.jsx("span",{className:"text-sm text-gray-500 ml-3 flex-shrink-0",children:s.date})]},s.id))})})]})})})(),ut&&e.jsx(Rs,{...ut,onClose:()=>Kt(null),onSermonSelect:t=>{B({...t,searchTerm:le||w}),H(0)}})]})})}export{Fs as default};
